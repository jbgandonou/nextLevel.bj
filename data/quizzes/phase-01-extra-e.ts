import { QuizQuestion } from '../types';

export const phase01ExtraE: QuizQuestion[] = [
  // === Asset Management (q191-q195) → p1-secure-architecture ===
  {
    id: 'p1-q191',
    phaseId: 'phase-01',
    lessonId: 'p1-secure-architecture',
    question: 'Quel est l\'objectif principal d\'un inventaire des actifs (asset inventory) en cybersécurité ?',
    options: [
      'Réduire les coûts d\'achat de matériel informatique',
      'Identifier et cataloguer tous les actifs pour appliquer les contrôles de sécurité appropriés',
      'Accélérer le déploiement des mises à jour logicielles',
      'Remplacer les outils de surveillance réseau traditionnels',
    ],
    correctIndex: 1,
    explanation: 'Un inventaire des actifs permet d\'identifier et de cataloguer tous les actifs matériels, logiciels et informationnels d\'une organisation. Sans cette visibilité, il est impossible de protéger ce qu\'on ne connaît pas. L\'inventaire est la base de la gestion des risques et de la conformité (NIST CSF : fonction "Identify").',
    difficulty: 'easy',
  },
  {
    id: 'p1-q192',
    phaseId: 'phase-01',
    lessonId: 'p1-secure-architecture',
    question: 'Quelle est la différence entre un actif tangible et un actif intangible en sécurité de l\'information ?',
    options: [
      'Un actif tangible est gratuit, un actif intangible est payant',
      'Un actif tangible est physique (serveurs, câbles), un actif intangible est immatériel (données, logiciels, réputation)',
      'Un actif tangible est interne, un actif intangible est externe',
      'Un actif tangible est sécurisé par défaut, un actif intangible ne l\'est jamais',
    ],
    correctIndex: 1,
    explanation: 'Les actifs tangibles sont des éléments physiques comme les serveurs, postes de travail, câbles et équipements réseau. Les actifs intangibles sont immatériels : données, propriété intellectuelle, logiciels, réputation et savoir-faire. Les deux types nécessitent des mesures de protection adaptées à leur nature.',
    difficulty: 'easy',
  },
  {
    id: 'p1-q193',
    phaseId: 'phase-01',
    lessonId: 'p1-secure-architecture',
    question: 'Qu\'est-ce que le cycle de vie d\'un actif (asset lifecycle) en gestion de la sécurité ?',
    options: [
      'La durée de garantie d\'un équipement informatique',
      'Les phases d\'acquisition, déploiement, maintenance, et mise hors service sécurisée d\'un actif',
      'Le temps nécessaire pour restaurer un actif après un incident',
      'La fréquence de remplacement des équipements réseau',
    ],
    correctIndex: 1,
    explanation: 'Le cycle de vie d\'un actif comprend toutes les phases depuis son acquisition jusqu\'à sa mise hors service : planification, acquisition, déploiement, exploitation, maintenance, et décommissionnement sécurisé. À chaque phase, des contrôles de sécurité spécifiques doivent être appliqués, notamment l\'effacement sécurisé des données lors de la mise hors service.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q194',
    phaseId: 'phase-01',
    lessonId: 'p1-secure-architecture',
    question: 'Pourquoi est-il important de maintenir un registre des propriétaires d\'actifs (asset owners) ?',
    options: [
      'Pour facturer les coûts de maintenance aux bons départements',
      'Pour définir la responsabilité de la protection et de la classification de chaque actif',
      'Pour limiter le nombre d\'utilisateurs par équipement',
      'Pour automatiser les sauvegardes de données',
    ],
    correctIndex: 1,
    explanation: 'Attribuer un propriétaire à chaque actif garantit qu\'une personne ou un département est responsable de sa classification, de sa protection et de la gestion de son cycle de vie. Sans propriétaire désigné, les actifs risquent de ne pas être correctement protégés ou mis à jour. C\'est une exigence clé d\'ISO 27001.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q195',
    phaseId: 'phase-01',
    lessonId: 'p1-secure-architecture',
    question: 'Quel outil ou processus permet la découverte automatique des actifs sur un réseau d\'entreprise ?',
    options: [
      'Un pare-feu de nouvelle génération (NGFW)',
      'Un scanner de découverte réseau combiné à une CMDB (Configuration Management Database)',
      'Un système de prévention d\'intrusion (IPS)',
      'Un outil de gestion des mots de passe (password manager)',
    ],
    correctIndex: 1,
    explanation: 'Les scanners de découverte réseau (comme Nmap, Qualys, ou les agents de gestion) identifient automatiquement les appareils, services et logiciels présents sur le réseau. Ces informations sont centralisées dans une CMDB qui maintient un inventaire à jour. Cette approche automatisée est essentielle car les inventaires manuels deviennent rapidement obsolètes dans les environnements dynamiques.',
    difficulty: 'hard',
  },

  // === Security Awareness Training (q196-q200) → p1-governance-compliance ===
  {
    id: 'p1-q196',
    phaseId: 'phase-01',
    lessonId: 'p1-governance-compliance',
    question: 'Quel est l\'objectif principal d\'un programme de sensibilisation à la sécurité (security awareness training) ?',
    options: [
      'Certifier tous les employés en cybersécurité avancée',
      'Réduire le risque humain en formant les employés à reconnaître et éviter les menaces',
      'Remplacer les contrôles techniques par des contrôles humains',
      'Satisfaire uniquement les exigences d\'audit sans impact réel',
    ],
    correctIndex: 1,
    explanation: 'Un programme de sensibilisation à la sécurité vise à réduire le facteur de risque humain, qui est impliqué dans plus de 80% des violations de données. Il forme les employés à reconnaître les tentatives de phishing, à gérer correctement les données sensibles et à suivre les politiques de sécurité de l\'organisation.',
    difficulty: 'easy',
  },
  {
    id: 'p1-q197',
    phaseId: 'phase-01',
    lessonId: 'p1-governance-compliance',
    question: 'Quelle méthode est la plus efficace pour évaluer l\'efficacité d\'un programme de sensibilisation à la sécurité ?',
    options: [
      'Compter le nombre de sessions de formation dispensées',
      'Mener des campagnes de phishing simulé et mesurer le taux de clic au fil du temps',
      'Vérifier que tous les employés ont signé la politique de sécurité',
      'Installer un nouvel antivirus sur tous les postes de travail',
    ],
    correctIndex: 1,
    explanation: 'Les campagnes de phishing simulé permettent de mesurer concrètement le comportement des employés face aux menaces. En suivant le taux de clic au fil du temps, on peut évaluer l\'amélioration réelle de la vigilance. Cette approche fournit des métriques objectives, contrairement au simple comptage des formations dispensées.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q198',
    phaseId: 'phase-01',
    lessonId: 'p1-governance-compliance',
    question: 'Quels sujets doivent être couverts dans une formation de sensibilisation à la sécurité conforme au SY0-701 ?',
    options: [
      'Uniquement la gestion des mots de passe et l\'utilisation du VPN',
      'Phishing, ingénierie sociale, gestion des mots de passe, classification des données, signalement des incidents, utilisation acceptable',
      'Uniquement les procédures de sauvegarde des données',
      'Exclusivement les aspects techniques du chiffrement',
    ],
    correctIndex: 1,
    explanation: 'Un programme complet de sensibilisation doit couvrir : la reconnaissance du phishing et de l\'ingénierie sociale, la gestion sécurisée des mots de passe, la classification et la manipulation des données sensibles, les procédures de signalement des incidents, et la politique d\'utilisation acceptable des ressources IT. Le contenu doit être adapté au rôle de chaque employé.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q199',
    phaseId: 'phase-01',
    lessonId: 'p1-governance-compliance',
    question: 'Qu\'est-ce qu\'une formation de sensibilisation basée sur les rôles (role-based security training) ?',
    options: [
      'Une formation identique pour tous les employés de l\'organisation',
      'Une formation adaptée aux responsabilités spécifiques de chaque rôle (développeurs, dirigeants, RH, etc.)',
      'Une formation réservée uniquement à l\'équipe de sécurité informatique',
      'Un programme de certification obligatoire pour les administrateurs système',
    ],
    correctIndex: 1,
    explanation: 'La formation basée sur les rôles adapte le contenu aux responsabilités spécifiques : les développeurs reçoivent une formation sur le codage sécurisé (OWASP), les dirigeants sur la gouvernance et la gestion des risques, les RH sur la protection des données personnelles, et le personnel général sur le phishing et les bonnes pratiques. Cette approche ciblée est plus efficace qu\'une formation générique unique.',
    difficulty: 'hard',
  },
  {
    id: 'p1-q200',
    phaseId: 'phase-01',
    lessonId: 'p1-governance-compliance',
    question: 'À quelle fréquence minimale un programme de sensibilisation à la sécurité doit-il être dispensé selon les bonnes pratiques ?',
    options: [
      'Une seule fois lors de l\'embauche',
      'Annuellement, avec des rappels réguliers et des simulations de phishing périodiques',
      'Uniquement après un incident de sécurité',
      'Tous les cinq ans lors du renouvellement des certifications',
    ],
    correctIndex: 1,
    explanation: 'Les bonnes pratiques et la plupart des cadres réglementaires (PCI DSS, HIPAA, RGPD) exigent une formation annuelle obligatoire complétée par des rappels réguliers et des simulations de phishing périodiques. Une formation unique lors de l\'embauche est insuffisante car les menaces évoluent constamment et les connaissances se dégradent avec le temps.',
    difficulty: 'medium',
  },

  // === Automation & SOAR (q201-q205) → p1-incident-response ===
  {
    id: 'p1-q201',
    phaseId: 'phase-01',
    lessonId: 'p1-incident-response',
    question: 'Qu\'est-ce qu\'un playbook dans le contexte du SOAR (Security Orchestration, Automation and Response) ?',
    options: [
      'Un guide de formation pour les nouveaux analystes SOC',
      'Un ensemble de procédures automatisées définissant les étapes de réponse à un type d\'incident spécifique',
      'Un rapport mensuel de conformité généré automatiquement',
      'Une liste de contrôle pour l\'audit annuel de sécurité',
    ],
    correctIndex: 1,
    explanation: 'Un playbook SOAR est un workflow automatisé qui définit les étapes précises de réponse à un type d\'incident spécifique (phishing, malware, tentative de brute force, etc.). Il orchestre les actions entre différents outils de sécurité (SIEM, pare-feu, EDR, ticketing) pour exécuter automatiquement des tâches comme l\'isolement d\'un hôte, l\'enrichissement des IoC ou la notification des parties prenantes.',
    difficulty: 'easy',
  },
  {
    id: 'p1-q202',
    phaseId: 'phase-01',
    lessonId: 'p1-incident-response',
    question: 'Quels sont les trois piliers du SOAR (Security Orchestration, Automation and Response) ?',
    options: [
      'Chiffrement, Authentification, Autorisation',
      'Orchestration des outils, Automatisation des tâches, Réponse aux incidents',
      'Surveillance, Alerte, Rapport',
      'Prévention, Détection, Correction',
    ],
    correctIndex: 1,
    explanation: 'Le SOAR repose sur trois piliers : l\'Orchestration (intégration et coordination de multiples outils de sécurité), l\'Automatisation (exécution automatique des tâches répétitives comme l\'enrichissement des alertes et le tri), et la Réponse (exécution de playbooks de réponse aux incidents avec des workflows structurés). Ces trois composants travaillent ensemble pour accélérer et standardiser la gestion des incidents.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q203',
    phaseId: 'phase-01',
    lessonId: 'p1-incident-response',
    question: 'Quel est le principal avantage de l\'intégration d\'un SOAR avec un SIEM ?',
    options: [
      'Remplacer complètement le SIEM par le SOAR',
      'Automatiser le tri et l\'enrichissement des alertes SIEM pour réduire la fatigue des analystes',
      'Éliminer le besoin de journalisation des événements',
      'Chiffrer automatiquement toutes les communications réseau',
    ],
    correctIndex: 1,
    explanation: 'L\'intégration SOAR-SIEM permet d\'automatiser le traitement des alertes générées par le SIEM. Le SOAR peut automatiquement enrichir les alertes avec des données de threat intelligence, filtrer les faux positifs, prioriser les incidents et exécuter des actions de réponse initiales. Cela réduit considérablement la fatigue des analystes (alert fatigue) et le temps moyen de réponse (MTTR).',
    difficulty: 'medium',
  },
  {
    id: 'p1-q204',
    phaseId: 'phase-01',
    lessonId: 'p1-incident-response',
    question: 'Qu\'est-ce que le concept de "runbook" et en quoi diffère-t-il d\'un playbook ?',
    options: [
      'Un runbook est identique à un playbook, les termes sont interchangeables',
      'Un runbook documente des procédures opérationnelles standardisées, tandis qu\'un playbook est spécifique à la réponse aux incidents de sécurité',
      'Un runbook est utilisé uniquement pour les sauvegardes, un playbook pour la restauration',
      'Un runbook est automatisé, un playbook est toujours manuel',
    ],
    correctIndex: 1,
    explanation: 'Un runbook est un ensemble de procédures opérationnelles standardisées pour des tâches IT courantes (maintenance, déploiement, dépannage). Un playbook, dans le contexte de la sécurité, est spécifiquement conçu pour guider la réponse à des incidents de sécurité spécifiques. Les deux peuvent être automatisés, mais le playbook est axé sur la sécurité et intégré aux outils SOAR.',
    difficulty: 'hard',
  },
  {
    id: 'p1-q205',
    phaseId: 'phase-01',
    lessonId: 'p1-incident-response',
    question: 'Quels sont les risques à considérer lors de la mise en place de l\'automatisation de la réponse aux incidents ?',
    options: [
      'L\'automatisation est toujours sans risque et ne nécessite aucune supervision',
      'Faux positifs déclenchant des actions automatiques inappropriées, complexité de maintenance et dépendance excessive',
      'Le seul risque est le coût élevé des licences SOAR',
      'L\'automatisation ralentit systématiquement la réponse aux incidents',
    ],
    correctIndex: 1,
    explanation: 'L\'automatisation de la réponse aux incidents comporte plusieurs risques : les faux positifs peuvent déclencher des actions automatiques inappropriées (comme l\'isolement d\'un serveur de production légitime), la complexité de maintenance des playbooks augmente avec le temps, et une dépendance excessive à l\'automatisation peut atrophier les compétences des analystes. Il est crucial de maintenir une supervision humaine (human-in-the-loop) pour les actions à fort impact.',
    difficulty: 'hard',
  },

  // === Technical Debt (q206-q210) → p1-governance-compliance ===
  {
    id: 'p1-q206',
    phaseId: 'phase-01',
    lessonId: 'p1-governance-compliance',
    question: 'Qu\'est-ce que la dette technique (technical debt) dans le contexte de la cybersécurité ?',
    options: [
      'Le coût financier des licences logicielles non payées',
      'L\'accumulation de choix techniques sous-optimaux qui créent des risques de sécurité croissants au fil du temps',
      'Le retard dans la livraison de projets informatiques',
      'Le budget alloué à la maintenance des équipements réseau',
    ],
    correctIndex: 1,
    explanation: 'La dette technique en sécurité désigne l\'accumulation de raccourcis techniques (systèmes non patchés, configurations par défaut, code legacy) qui augmentent progressivement le risque. Comme une dette financière, elle accumule des "intérêts" — plus on attend, plus le coût et le risque de correction augmentent.',
    difficulty: 'easy',
  },
  {
    id: 'p1-q207',
    phaseId: 'phase-01',
    lessonId: 'p1-governance-compliance',
    question: 'Quel est l\'exemple le plus courant de dette technique représentant un risque de sécurité ?',
    options: [
      'Un serveur avec trop de RAM installée',
      'Un système d\'exploitation en fin de vie (end-of-life) qui ne reçoit plus de correctifs de sécurité',
      'Un réseau avec une bande passante trop élevée',
      'Une application développée avec un langage de programmation récent',
    ],
    correctIndex: 1,
    explanation: 'Les systèmes d\'exploitation en fin de vie (comme Windows Server 2012 ou CentOS 6) ne reçoivent plus de correctifs de sécurité. Les vulnérabilités découvertes ne seront jamais corrigées, ce qui expose l\'organisation à des exploits connus. C\'est une forme critique de dette technique.',
    difficulty: 'easy',
  },
  {
    id: 'p1-q208',
    phaseId: 'phase-01',
    lessonId: 'p1-governance-compliance',
    question: 'Comment une organisation devrait-elle gérer la dette technique lorsque la migration immédiate d\'un système legacy n\'est pas possible ?',
    options: [
      'Ignorer le problème jusqu\'à ce qu\'un incident se produise',
      'Mettre en place des contrôles compensatoires : segmentation réseau, monitoring renforcé et restrictions d\'accès',
      'Déconnecter immédiatement le système sans plan de remplacement',
      'Publier les vulnérabilités connues pour sensibiliser les utilisateurs',
    ],
    correctIndex: 1,
    explanation: 'Quand la migration immédiate est impossible, les contrôles compensatoires atténuent le risque : isoler le système dans un segment réseau dédié (microsegmentation), renforcer le monitoring (IDS/IPS), limiter les accès au strict nécessaire, et planifier activement le remplacement. Cette approche équilibre risque et continuité opérationnelle.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q209',
    phaseId: 'phase-01',
    lessonId: 'p1-governance-compliance',
    question: 'Pourquoi les dépendances logicielles obsolètes (comme Log4j non mis à jour) sont-elles considérées comme de la dette technique critique ?',
    options: [
      'Parce qu\'elles ralentissent le temps de compilation du code',
      'Parce qu\'elles contiennent des CVE connues exploitables à grande échelle, mais leur mise à jour peut casser la compatibilité applicative',
      'Parce qu\'elles augmentent les coûts de stockage des serveurs',
      'Parce qu\'elles sont incompatibles avec les navigateurs modernes',
    ],
    correctIndex: 1,
    explanation: 'Les dépendances obsolètes avec des CVE connues (comme Log4Shell dans Log4j) représentent un risque immédiat car les exploits sont souvent publics et automatisés. La dette technique s\'accumule quand la mise à jour est repoussée par crainte de casser la compatibilité, créant un cercle vicieux de risque croissant.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q210',
    phaseId: 'phase-01',
    lessonId: 'p1-governance-compliance',
    question: 'Quelle approche est recommandée pour prioriser la réduction de la dette technique en matière de sécurité ?',
    options: [
      'Corriger toute la dette technique en une seule fois lors d\'un arrêt planifié',
      'Prioriser en fonction du risque : traiter d\'abord les systèmes exposés à Internet et ceux traitant des données sensibles',
      'Se concentrer uniquement sur les systèmes les plus anciens, indépendamment de leur exposition',
      'Attendre qu\'un audit externe identifie les priorités',
    ],
    correctIndex: 1,
    explanation: 'La priorisation basée sur le risque est essentielle : un système legacy exposé à Internet avec des données sensibles représente un risque bien plus élevé qu\'un serveur interne isolé. L\'approche recommandée combine l\'inventaire de la dette, l\'évaluation de l\'exposition et de l\'impact, et l\'allocation d\'un budget régulier (typiquement 20% du temps de développement) pour la réduction continue.',
    difficulty: 'hard',
  },

  // === Security Metrics & Reporting (q211-q215) → p1-incident-response ===
  {
    id: 'p1-q211',
    phaseId: 'phase-01',
    lessonId: 'p1-incident-response',
    question: 'Que mesure la métrique MTTD (Mean Time To Detect) ?',
    options: [
      'Le temps moyen entre deux pannes système',
      'Le temps moyen entre le début d\'un incident de sécurité et sa détection',
      'Le temps moyen pour déployer un correctif de sécurité',
      'Le temps moyen pour former un nouvel analyste SOC',
    ],
    correctIndex: 1,
    explanation: 'Le MTTD (Mean Time To Detect) mesure le temps moyen entre le début réel d\'un incident et le moment où il est détecté par l\'équipe de sécurité. Un MTTD élevé signifie que les attaquants ont plus de temps pour opérer dans l\'environnement. L\'objectif est de le réduire grâce au SIEM, à l\'EDR et au threat hunting proactif.',
    difficulty: 'easy',
  },
  {
    id: 'p1-q212',
    phaseId: 'phase-01',
    lessonId: 'p1-incident-response',
    question: 'Quelle combinaison de métriques est la plus pertinente pour évaluer l\'efficacité d\'une équipe de réponse aux incidents ?',
    options: [
      'Nombre d\'emails traités et taille de l\'équipe',
      'MTTD (temps de détection), MTTR (temps de réponse) et MTTC (temps de confinement)',
      'Budget du département et nombre de certifications des analystes',
      'Nombre de réunions par semaine et taux de satisfaction des employés',
    ],
    correctIndex: 1,
    explanation: 'Le trio MTTD/MTTR/MTTC mesure la performance complète de l\'équipe IR : la rapidité de détection (MTTD), le temps pour contenir la menace (MTTC) et le temps total de résolution (MTTR). La tendance de ces métriques dans le temps est plus importante que les valeurs absolues — une amélioration constante indique une équipe qui progresse.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q213',
    phaseId: 'phase-01',
    lessonId: 'p1-incident-response',
    question: 'Quelle métrique de gestion des vulnérabilités indique directement l\'exposition au risque d\'une organisation ?',
    options: [
      'Le nombre total de scans effectués par mois',
      'Le nombre de vulnérabilités critiques ouvertes et leur âge moyen',
      'Le coût des outils de scan de vulnérabilités',
      'Le nombre d\'analystes dans l\'équipe de gestion des vulnérabilités',
    ],
    correctIndex: 1,
    explanation: 'Le nombre de vulnérabilités critiques ouvertes combiné à leur âge moyen est l\'indicateur le plus direct du risque. Une organisation avec 50 vulnérabilités critiques non corrigées depuis 90 jours est bien plus exposée qu\'une organisation avec 5 vulnérabilités datant de 3 jours. Le temps de remédiation par sévérité doit être suivi : critique < 48h, haute < 7j, moyenne < 30j.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q214',
    phaseId: 'phase-01',
    lessonId: 'p1-incident-response',
    question: 'Quelle est la différence principale entre un dashboard opérationnel et un dashboard exécutif en sécurité ?',
    options: [
      'Le dashboard opérationnel est en couleur, l\'exécutif en noir et blanc',
      'Le dashboard opérationnel affiche des données temps réel pour le SOC, l\'exécutif présente des tendances et le ROI pour la direction',
      'Le dashboard opérationnel est mis à jour mensuellement, l\'exécutif quotidiennement',
      'Il n\'y a pas de différence, les deux affichent les mêmes données',
    ],
    correctIndex: 1,
    explanation: 'Les dashboards opérationnels sont conçus pour le SOC avec des données temps réel : alertes actives, incidents en cours, métriques de performance. Les dashboards exécutifs présentent des informations agrégées à la direction : tendances sur plusieurs mois, posture de risque globale, ROI des investissements en sécurité et conformité aux frameworks.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q215',
    phaseId: 'phase-01',
    lessonId: 'p1-incident-response',
    question: 'Un CISO doit justifier l\'investissement dans un programme de sécurité auprès du conseil d\'administration. Quelles métriques sont les plus convaincantes ?',
    options: [
      'Le nombre de règles de pare-feu configurées et le volume de logs collectés',
      'La réduction du MTTD/MTTR, la diminution des vulnérabilités critiques, le taux de conformité et le coût évité des incidents',
      'Le nombre d\'outils de sécurité déployés et leur coût total',
      'Le nombre de formations suivies par les analystes SOC',
    ],
    correctIndex: 1,
    explanation: 'La direction comprend les métriques orientées business : la réduction des temps de détection/réponse (moins d\'impact), la diminution des vulnérabilités critiques (moins de risque), la conformité aux frameworks (éviter les amendes), et le coût évité (incidents prévenus vs coût du programme). Ces métriques traduisent la sécurité en langage business.',
    difficulty: 'hard',
  },

  // === Risk Management (q216-q225) → p1-risk-management ===
  {
    id: 'p1-q216',
    phaseId: 'phase-01',
    lessonId: 'p1-risk-management',
    question: 'Quelle est la formule correcte pour calculer l\'ALE (Annual Loss Expectancy) ?',
    options: [
      'ALE = AV × EF',
      'ALE = ARO × SLE',
      'ALE = SLE ÷ ARO',
      'ALE = AV × ARO',
    ],
    correctIndex: 1,
    explanation: 'L\'ALE (Annual Loss Expectancy) se calcule en multipliant l\'ARO (Annual Rate of Occurrence — fréquence annuelle de l\'incident) par le SLE (Single Loss Expectancy — perte pour un incident unique). Le SLE lui-même se calcule par AV × EF (Asset Value × Exposure Factor).',
    difficulty: 'easy',
  },
  {
    id: 'p1-q217',
    phaseId: 'phase-01',
    lessonId: 'p1-risk-management',
    question: 'Quelles sont les quatre options de traitement du risque ?',
    options: [
      'Détecter, Prévenir, Corriger, Compenser',
      'Atténuer (mitigate), Transférer, Accepter, Éviter',
      'Identifier, Évaluer, Traiter, Surveiller',
      'Chiffrer, Segmenter, Patcher, Auditer',
    ],
    correctIndex: 1,
    explanation: 'Les quatre options de traitement sont : atténuer (réduire la probabilité ou l\'impact avec des contrôles), transférer (déplacer le risque vers un tiers comme une assurance cyber), accepter (reconnaître et documenter le risque résiduel), et éviter (éliminer l\'activité qui génère le risque).',
    difficulty: 'easy',
  },
  {
    id: 'p1-q218',
    phaseId: 'phase-01',
    lessonId: 'p1-risk-management',
    question: 'Quelle est la différence entre le risque inhérent et le risque résiduel ?',
    options: [
      'Le risque inhérent est technique, le résiduel est organisationnel',
      'Le risque inhérent est le niveau de risque avant application des contrôles, le résiduel est le risque restant après les contrôles',
      'Le risque inhérent concerne les actifs physiques, le résiduel les actifs numériques',
      'Il n\'y a pas de différence, les termes sont interchangeables',
    ],
    correctIndex: 1,
    explanation: 'Le risque inhérent est le niveau de risque "brut" avant toute mesure de sécurité. Le risque résiduel est ce qui reste après application des contrôles. Le risque résiduel doit être formellement accepté par la direction. Si le risque résiduel dépasse l\'appétit pour le risque de l\'organisation, des contrôles supplémentaires sont nécessaires.',
    difficulty: 'easy',
  },
  {
    id: 'p1-q219',
    phaseId: 'phase-01',
    lessonId: 'p1-risk-management',
    question: 'Que signifient RTO et RPO dans le contexte du BIA (Business Impact Analysis) ?',
    options: [
      'RTO = temps de rétention des données, RPO = point de restauration des opérations',
      'RTO = temps maximal acceptable d\'indisponibilité, RPO = quantité maximale de données que l\'on peut se permettre de perdre',
      'RTO = temps de réponse aux tickets, RPO = priorité de restauration des opérations',
      'RTO = temps de rotation des backups, RPO = plan de récupération des opérations',
    ],
    correctIndex: 1,
    explanation: 'Le RTO (Recovery Time Objective) définit le temps maximal acceptable avant la restauration du service. Le RPO (Recovery Point Objective) définit la quantité maximale de données perdues acceptable (ex: RPO de 1h signifie qu\'on tolère au maximum 1h de données perdues). Ces deux métriques guident la stratégie de sauvegarde et de reprise.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q220',
    phaseId: 'phase-01',
    lessonId: 'p1-risk-management',
    question: 'Quel framework d\'évaluation des risques est le seul à être purement quantitatif et basé sur l\'analyse financière ?',
    options: [
      'NIST SP 800-30',
      'OCTAVE',
      'FAIR (Factor Analysis of Information Risk)',
      'CRAMM',
    ],
    correctIndex: 2,
    explanation: 'FAIR est le seul framework purement quantitatif et standard ouvert. Il décompose le risque en facteurs mesurables : fréquence des événements de perte (Loss Event Frequency) et ampleur de la perte (Loss Magnitude). Il permet de produire des analyses financières exploitables par la direction, contrairement aux approches qualitatives.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q221',
    phaseId: 'phase-01',
    lessonId: 'p1-risk-management',
    question: 'Quelle est la différence entre un hot site, un warm site et un cold site pour la reprise après sinistre ?',
    options: [
      'Ils diffèrent uniquement par la température de leurs salles serveurs',
      'Hot site = opérationnel en minutes (réplique complète), warm site = opérationnel en heures (matériel prêt), cold site = opérationnel en jours (espace vide)',
      'Hot site = cloud, warm site = on-premise, cold site = sauvegarde bande',
      'Ils sont identiques mais avec des niveaux de chiffrement différents',
    ],
    correctIndex: 1,
    explanation: 'Le hot site est une réplique complète prête à prendre le relais en quelques minutes (le plus coûteux). Le warm site dispose du matériel mais nécessite la restauration des données (quelques heures). Le cold site est un espace avec l\'alimentation et la connectivité mais sans équipement (jours à semaines, le moins cher).',
    difficulty: 'medium',
  },
  {
    id: 'p1-q222',
    phaseId: 'phase-01',
    lessonId: 'p1-risk-management',
    question: 'Un serveur critique vaut 200 000 €. Une attaque ransomware (EF = 80%) se produit en moyenne 0,5 fois par an. Quel est l\'ALE ?',
    options: [
      '160 000 €',
      '80 000 €',
      '100 000 €',
      '40 000 €',
    ],
    correctIndex: 1,
    explanation: 'SLE = AV × EF = 200 000 × 0,80 = 160 000 €. ALE = ARO × SLE = 0,5 × 160 000 = 80 000 €. Cela signifie que l\'organisation peut s\'attendre à perdre 80 000 € par an à cause de cette menace. Un contrôle coûtant moins de 80 000 €/an pour l\'atténuer serait financièrement justifié.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q223',
    phaseId: 'phase-01',
    lessonId: 'p1-risk-management',
    question: 'Dans la classification gouvernementale des données, quel est l\'ordre du moins sensible au plus sensible ?',
    options: [
      'Public, Confidentiel, Secret, Top Secret',
      'Unclassified, Confidential, Secret, Top Secret',
      'Public, Interne, Confidentiel, Restreint',
      'Ouvert, Limité, Classifié, Ultra-secret',
    ],
    correctIndex: 1,
    explanation: 'La classification gouvernementale US (et largement adoptée) utilise 4 niveaux : Unclassified (non classifié), Confidential (dommage à la sécurité nationale), Secret (dommage sérieux), Top Secret (dommage exceptionnellement grave). Chaque niveau requiert des habilitations et des contrôles d\'accès de plus en plus stricts.',
    difficulty: 'hard',
  },
  {
    id: 'p1-q224',
    phaseId: 'phase-01',
    lessonId: 'p1-risk-management',
    question: 'Quel rôle dans la gouvernance des données est responsable de déterminer la classification et les contrôles d\'accès appropriés pour les données ?',
    options: [
      'Le data custodian (gardien des données)',
      'Le data owner (propriétaire des données)',
      'Le DPO (Data Protection Officer)',
      'L\'administrateur système',
    ],
    correctIndex: 1,
    explanation: 'Le data owner est généralement un cadre ou responsable métier qui détermine la classification des données et les politiques d\'accès. Le data custodian (souvent l\'équipe IT) implémente techniquement ces contrôles. Le DPO supervise la conformité RGPD. La distinction owner/custodian est fréquemment testée au Security+.',
    difficulty: 'hard',
  },
  {
    id: 'p1-q225',
    phaseId: 'phase-01',
    lessonId: 'p1-risk-management',
    question: 'Qu\'est-ce que le Third-Party Risk Management (TPRM) et pourquoi est-il critique ?',
    options: [
      'La gestion des risques liés aux catastrophes naturelles',
      'L\'évaluation et la gestion continue des risques de sécurité introduits par les fournisseurs, partenaires et prestataires externes',
      'La gestion des risques financiers liés aux investissements',
      'L\'audit interne des équipes de développement',
    ],
    correctIndex: 1,
    explanation: 'Le TPRM évalue les risques liés aux tiers (fournisseurs cloud, SaaS, sous-traitants) qui ont accès aux systèmes ou données de l\'organisation. L\'attaque SolarWinds a démontré l\'importance critique du TPRM. Les outils incluent les questionnaires de sécurité, les rapports SOC 2, les SLA et le right-to-audit.',
    difficulty: 'hard',
  },
];
