import { QuizQuestion } from '../types';

export const phase01ExtraD: QuizQuestion[] = [
  // === Cryptographie (q171-q177) ===
  {
    id: 'p1-q171',
    phaseId: 'phase-01',
    lessonId: 'p1-cryptographie',
    question: 'Une startup lance un site e-commerce et souhaite obtenir rapidement un certificat SSL/TLS pour sécuriser les transactions. Le budget est limité et ils n\'ont pas besoin de vérification d\'identité approfondie. Quel type de certificat est le PLUS approprié ?',
    options: [
      'Un certificat Extended Validation (EV) pour afficher la barre verte',
      'Un certificat Domain Validation (DV) qui vérifie uniquement la propriété du domaine',
      'Un certificat Organization Validation (OV) avec vérification de l\'entreprise',
      'Un certificat auto-signé généré en interne',
    ],
    correctIndex: 1,
    explanation: 'Un certificat DV (Domain Validation) est le plus rapide et le moins coûteux à obtenir. Il vérifie uniquement que le demandeur contrôle le domaine. Pour une startup avec un budget limité qui a besoin d\'un certificat rapidement, c\'est le choix le plus approprié. Les certificats OV et EV nécessitent des vérifications supplémentaires et coûtent plus cher.',
    difficulty: 'easy',
  },
  {
    id: 'p1-q172',
    phaseId: 'phase-01',
    lessonId: 'p1-cryptographie',
    question: 'Une entreprise gère plusieurs sous-domaines (mail.exemple.com, shop.exemple.com, api.exemple.com) et souhaite un seul certificat pour tous les sécuriser. Le directeur IT hésite entre deux options. Quelle solution est la PLUS adaptée ?',
    options: [
      'Acheter un certificat DV séparé pour chaque sous-domaine',
      'Utiliser un certificat wildcard (*.exemple.com) qui couvre tous les sous-domaines',
      'Utiliser un certificat SAN uniquement si les domaines sont sur des TLD différents',
      'Générer des certificats auto-signés pour chaque sous-domaine',
    ],
    correctIndex: 1,
    explanation: 'Un certificat wildcard (*.exemple.com) permet de sécuriser un nombre illimité de sous-domaines d\'un même domaine avec un seul certificat. C\'est la solution la plus économique et la plus simple à gérer quand tous les sous-domaines partagent le même domaine parent. Un certificat SAN serait plus adapté si les domaines étaient complètement différents (exemple.com, autresite.com).',
    difficulty: 'medium',
  },
  {
    id: 'p1-q173',
    phaseId: 'phase-01',
    lessonId: 'p1-cryptographie',
    question: 'Un administrateur découvre que la clé privée du serveur web principal a été compromise. Les utilisateurs doivent être protégés immédiatement. Quelle action doit être effectuée EN PREMIER ?',
    options: [
      'Renouveler le certificat à son expiration normale',
      'Révoquer le certificat compromis via la CA et publier la mise à jour dans la CRL ou via OCSP',
      'Changer le mot de passe administrateur du serveur web',
      'Désactiver temporairement le site web et attendre les instructions du management',
    ],
    correctIndex: 1,
    explanation: 'Lorsqu\'une clé privée est compromise, le certificat associé doit être immédiatement révoqué auprès de l\'autorité de certification (CA). La CA met à jour la CRL (Certificate Revocation List) ou le répondeur OCSP (Online Certificate Status Protocol) pour informer les clients que le certificat n\'est plus fiable. Attendre l\'expiration normale exposerait les utilisateurs à des attaques man-in-the-middle.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q174',
    phaseId: 'phase-01',
    lessonId: 'p1-cryptographie',
    question: 'Une grande organisation déploie une infrastructure PKI interne. L\'architecte sécurité recommande de garder la CA racine hors ligne et d\'utiliser des CA intermédiaires pour émettre les certificats. Quelle est la raison PRINCIPALE de cette architecture ?',
    options: [
      'Réduire le coût des licences logicielles pour les serveurs CA',
      'Protéger la CA racine contre toute compromission en limitant son exposition réseau',
      'Accélérer le processus d\'émission des certificats pour les utilisateurs',
      'Permettre l\'utilisation de certificats wildcard sur tous les domaines',
    ],
    correctIndex: 1,
    explanation: 'Dans une hiérarchie PKI, la CA racine est l\'ancre de confiance de toute l\'infrastructure. En la gardant hors ligne (déconnectée du réseau), on minimise drastiquement le risque de compromission. Les CA intermédiaires, qui sont en ligne, émettent les certificats au quotidien. Si une CA intermédiaire est compromise, on peut la révoquer sans compromettre toute la chaîne de confiance.',
    difficulty: 'hard',
  },
  {
    id: 'p1-q175',
    phaseId: 'phase-01',
    lessonId: 'p1-cryptographie',
    question: 'Le RSSI d\'une banque exige que les clés de chiffrement utilisées pour protéger les données clients suivent un cycle de vie strict. Un auditeur demande quel processus garantit qu\'une clé ne sera jamais réutilisée après sa période de validité. De quel aspect du cycle de vie des clés s\'agit-il ?',
    options: [
      'La génération de clés avec un algorithme approuvé',
      'La distribution sécurisée des clés aux parties autorisées',
      'L\'expiration et la destruction des clés selon la politique définie',
      'Le stockage des clés dans un répertoire centralisé',
    ],
    correctIndex: 2,
    explanation: 'Le cycle de vie des clés cryptographiques comprend la génération, la distribution, le stockage, l\'utilisation, la rotation, l\'archivage et la destruction. L\'expiration et la destruction garantissent qu\'une clé n\'est plus utilisée après sa période de validité, réduisant le risque qu\'une clé ancienne soit compromise et utilisée pour déchiffrer des données. C\'est un aspect crucial de la gestion des clés (key management).',
    difficulty: 'hard',
  },
  {
    id: 'p1-q176',
    phaseId: 'phase-01',
    lessonId: 'p1-cryptographie',
    question: 'Une institution financière doit protéger ses clés de chiffrement les plus sensibles contre toute extraction logicielle ou physique. Le responsable sécurité évalue différentes solutions de stockage. Quelle solution offre le MEILLEUR niveau de protection ?',
    options: [
      'Stocker les clés dans un fichier chiffré sur le serveur de fichiers',
      'Utiliser un HSM (Hardware Security Module) certifié FIPS 140-2 niveau 3',
      'Conserver les clés dans une base de données chiffrée avec accès restreint',
      'Stocker les clés sur une clé USB chiffrée dans un coffre-fort physique',
    ],
    correctIndex: 1,
    explanation: 'Un HSM (Hardware Security Module) est un dispositif matériel dédié conçu pour générer, stocker et gérer des clés cryptographiques de manière sécurisée. Certifié FIPS 140-2 niveau 3, il offre une protection contre les tentatives d\'extraction physique et logique des clés. Les clés ne quittent jamais le HSM, et toute tentative de manipulation physique déclenche l\'effacement automatique des clés.',
    difficulty: 'hard',
  },
  {
    id: 'p1-q177',
    phaseId: 'phase-01',
    lessonId: 'p1-cryptographie',
    question: 'Lors d\'une réunion stratégique, le CTO demande à l\'équipe sécurité de préparer la migration vers des algorithmes résistants aux ordinateurs quantiques. Quel est le risque PRINCIPAL que pose l\'informatique quantique pour la cryptographie actuelle ?',
    options: [
      'Les ordinateurs quantiques peuvent casser les algorithmes de hachage SHA-256 instantanément',
      'Les ordinateurs quantiques peuvent résoudre efficacement les problèmes mathématiques sur lesquels reposent RSA et ECC, rendant ces algorithmes vulnérables',
      'Les ordinateurs quantiques rendent tous les protocoles de chiffrement symétrique obsolètes',
      'Les ordinateurs quantiques empêchent la génération de nombres aléatoires sécurisés',
    ],
    correctIndex: 1,
    explanation: 'L\'algorithme de Shor, exécuté sur un ordinateur quantique suffisamment puissant, peut résoudre efficacement la factorisation de grands nombres premiers (RSA) et le problème du logarithme discret sur courbes elliptiques (ECC). Cela rendrait ces algorithmes asymétriques vulnérables. Le chiffrement symétrique (AES) est moins affecté, nécessitant simplement des tailles de clés doublées. Le NIST travaille activement sur des algorithmes post-quantiques comme CRYSTALS-Kyber.',
    difficulty: 'hard',
  },

  // === IAM (q178-q183) ===
  {
    id: 'p1-q178',
    phaseId: 'phase-01',
    lessonId: 'p1-iam',
    question: 'Une entreprise multinationale utilise le SSO fédéré pour permettre à ses employés d\'accéder aux applications de ses filiales sans créer de nouveaux comptes. Un partenaire commercial demande également l\'accès. Quel concept permet d\'étendre cette confiance au partenaire ?',
    options: [
      'L\'authentification multifacteur (MFA) obligatoire pour les partenaires',
      'La confiance transitive (transitive trust) entre les domaines fédérés',
      'La création de comptes locaux dédiés pour chaque employé du partenaire',
      'L\'utilisation d\'un VPN site-à-site entre les deux organisations',
    ],
    correctIndex: 1,
    explanation: 'La confiance transitive dans une fédération SSO signifie que si l\'organisation A fait confiance à B, et B fait confiance à C, alors A peut étendre cette confiance à C. Cela permet d\'intégrer des partenaires commerciaux dans l\'écosystème SSO sans créer de comptes séparés, en s\'appuyant sur des protocoles comme SAML ou OpenID Connect pour établir la confiance entre les fournisseurs d\'identité.',
    difficulty: 'hard',
  },
  {
    id: 'p1-q179',
    phaseId: 'phase-01',
    lessonId: 'p1-iam',
    question: 'Un développeur conçoit une application mobile qui doit accéder aux photos Google Drive de l\'utilisateur sans jamais stocker son mot de passe Google. Quel protocole d\'autorisation est le MIEUX adapté ?',
    options: [
      'LDAP pour interroger l\'annuaire Google directement',
      'OAuth 2.0 avec un jeton d\'accès à portée limitée',
      'Kerberos avec un ticket de service pour Google Drive',
      'RADIUS pour authentifier l\'utilisateur auprès de Google',
    ],
    correctIndex: 1,
    explanation: 'OAuth 2.0 est le protocole d\'autorisation standard qui permet à une application tierce d\'accéder aux ressources d\'un utilisateur sans connaître ses identifiants. L\'utilisateur s\'authentifie directement auprès de Google, qui émet un jeton d\'accès (access token) avec des permissions limitées (scope) à l\'application. Le mot de passe n\'est jamais partagé avec l\'application tierce.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q180',
    phaseId: 'phase-01',
    lessonId: 'p1-iam',
    question: 'Lors d\'un audit de conformité, l\'auditeur constate que plusieurs comptes utilisateurs appartiennent à des employés ayant quitté l\'entreprise il y a plus de six mois. Quel processus aurait dû empêcher cette situation ?',
    options: [
      'Une politique de complexité des mots de passe plus stricte',
      'Un processus de recertification des comptes (account recertification) périodique',
      'L\'activation de l\'authentification biométrique pour tous les comptes',
      'La mise en place d\'un portail self-service de réinitialisation de mot de passe',
    ],
    correctIndex: 1,
    explanation: 'La recertification des comptes est un processus périodique au cours duquel les responsables vérifient que les comptes et les droits d\'accès attribués sont toujours légitimes et nécessaires. Ce processus permet d\'identifier les comptes orphelins (employés partis), les permissions excessives et les accès obsolètes. C\'est une exigence courante dans les cadres de conformité comme SOX et ISO 27001.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q181',
    phaseId: 'phase-01',
    lessonId: 'p1-iam',
    question: 'Un pentester réussit à accéder à un serveur web en utilisant les identifiants par défaut du panneau d\'administration. Quelle mesure de sécurité fondamentale a été négligée ?',
    options: [
      'Le chiffrement des données au repos sur le serveur',
      'La désactivation ou le changement des comptes et mots de passe par défaut',
      'L\'installation d\'un certificat SSL/TLS sur le serveur',
      'La mise en place d\'une sauvegarde quotidienne des données',
    ],
    correctIndex: 1,
    explanation: 'La désactivation ou la modification des comptes par défaut est une mesure de durcissement (hardening) fondamentale. De nombreux systèmes, applications et équipements réseau sont livrés avec des identifiants par défaut (admin/admin, root/password, etc.) qui sont publiquement documentés. Ne pas les modifier est l\'une des failles de sécurité les plus courantes et les plus facilement exploitables.',
    difficulty: 'easy',
  },
  {
    id: 'p1-q182',
    phaseId: 'phase-01',
    lessonId: 'p1-iam',
    question: 'L\'équipe DevOps utilise un compte de service avec des privilèges élevés pour exécuter des scripts automatisés sur les serveurs de production. Un audit révèle que ce même compte est partagé entre huit ingénieurs. Quelle est la MEILLEURE recommandation ?',
    options: [
      'Augmenter la complexité du mot de passe du compte de service',
      'Attribuer des comptes de service individuels avec le principe du moindre privilège et activer la journalisation',
      'Désactiver complètement les comptes de service et faire tout manuellement',
      'Créer un groupe Active Directory contenant les huit ingénieurs avec les mêmes droits',
    ],
    correctIndex: 1,
    explanation: 'Les comptes de service partagés posent un problème majeur de traçabilité (accountability) car il est impossible de savoir qui a effectué quelle action. La meilleure pratique consiste à attribuer des comptes de service individuels, à appliquer le principe du moindre privilège et à activer une journalisation détaillée. Cela permet de tracer chaque action à un individu spécifique.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q183',
    phaseId: 'phase-01',
    lessonId: 'p1-iam',
    question: 'Le RSSI souhaite implémenter une solution qui contrôle et surveille en temps réel toutes les sessions des administrateurs systèmes lorsqu\'ils accèdent aux serveurs critiques. Quelle solution répond le MIEUX à ce besoin ?',
    options: [
      'Un système de gestion des accès privilégiés (PAM - Privileged Access Management)',
      'Un réseau privé virtuel (VPN) avec authentification par certificat',
      'Un système de détection d\'intrusion (IDS) sur le réseau interne',
      'Un portail web d\'authentification unique (SSO) pour les administrateurs',
    ],
    correctIndex: 0,
    explanation: 'Une solution PAM (Privileged Access Management) est spécialement conçue pour gérer, contrôler et surveiller les accès privilégiés. Elle offre des fonctionnalités comme le coffre-fort de mots de passe, l\'enregistrement des sessions, l\'élévation de privilèges juste-à-temps (JIT), et l\'approbation de workflow. Des solutions comme CyberArk ou BeyondTrust permettent de visualiser en temps réel ce que font les administrateurs sur les systèmes critiques.',
    difficulty: 'medium',
  },

  // === Network Security (q184-q190) ===
  {
    id: 'p1-q184',
    phaseId: 'phase-01',
    lessonId: 'p1-network-security',
    question: 'Le SOC détecte une alerte IDS indiquant un trafic réseau correspondant à un pattern connu d\'exploitation de la vulnérabilité EternalBlue. Quel type de détection l\'IDS a-t-il utilisé ?',
    options: [
      'La détection basée sur les anomalies comportementales',
      'La détection basée sur les signatures (pattern matching)',
      'La détection basée sur l\'analyse heuristique',
      'La détection basée sur le machine learning',
    ],
    correctIndex: 1,
    explanation: 'La détection basée sur les signatures compare le trafic réseau à une base de données de patterns (signatures) correspondant à des attaques connues. EternalBlue ayant un pattern de trafic spécifique et documenté, l\'IDS l\'a identifié par correspondance de signature. La détection par anomalies, en revanche, établit une baseline du trafic normal et alerte sur les déviations, sans nécessiter de signatures prédéfinies.',
    difficulty: 'easy',
  },
  {
    id: 'p1-q185',
    phaseId: 'phase-01',
    lessonId: 'p1-network-security',
    question: 'L\'équipe sécurité souhaite attirer les attaquants vers un système isolé pour étudier leurs techniques sans mettre en danger l\'infrastructure de production. Ils veulent simuler un réseau complet avec plusieurs serveurs vulnérables. Quelle solution doivent-ils déployer ?',
    options: [
      'Un pare-feu de nouvelle génération (NGFW) en mode transparent',
      'Un honeynet composé de plusieurs honeypots simulant un réseau réaliste',
      'Un système de prévention d\'intrusion (IPS) en mode inline',
      'Un proxy inverse configuré pour rediriger le trafic malveillant',
    ],
    correctIndex: 1,
    explanation: 'Un honeynet est un réseau de honeypots interconnectés qui simule un environnement de production réaliste. Contrairement à un honeypot unique qui simule un seul système, un honeynet offre un réseau complet avec des serveurs, des services et des données factices. Il permet d\'observer les techniques, tactiques et procédures (TTP) des attaquants dans un environnement contrôlé et isolé du réseau de production.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q186',
    phaseId: 'phase-01',
    lessonId: 'p1-network-security',
    question: 'Un hôpital souhaite s\'assurer que seuls les appareils conformes à la politique de sécurité puissent se connecter au réseau filaire. Lorsqu\'un appareil non autorisé est branché sur une prise réseau, il doit être automatiquement isolé. Quel protocole répond à ce besoin ?',
    options: [
      'SNMP v3 pour surveiller les équipements réseau',
      'IEEE 802.1X pour l\'authentification port-based sur les commutateurs',
      'DHCP snooping pour filtrer les requêtes DHCP malveillantes',
      'STP (Spanning Tree Protocol) pour prévenir les boucles réseau',
    ],
    correctIndex: 1,
    explanation: 'IEEE 802.1X est un standard d\'authentification port-based qui contrôle l\'accès au réseau au niveau du commutateur. Quand un appareil se connecte, le commutateur (authenticator) demande des identifiants via EAP, les transmet au serveur RADIUS (authentication server), et n\'ouvre le port que si l\'authentification réussit. Les appareils non authentifiés sont placés dans un VLAN de quarantaine ou bloqués.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q187',
    phaseId: 'phase-01',
    lessonId: 'p1-network-security',
    question: 'Un hôtel souhaite offrir un accès Wi-Fi gratuit à ses clients. Avant d\'accéder à Internet, chaque client doit accepter les conditions d\'utilisation et s\'enregistrer avec son nom et numéro de chambre. Quelle technologie doit être mise en place ?',
    options: [
      'Un filtre MAC pour autoriser uniquement les appareils enregistrés à la réception',
      'Un portail captif (captive portal) qui redirige les utilisateurs vers une page d\'authentification',
      'Un serveur proxy transparent qui bloque l\'accès non autorisé',
      'Un réseau WPA3-Enterprise avec des identifiants individuels par chambre',
    ],
    correctIndex: 1,
    explanation: 'Un portail captif intercepte les requêtes HTTP des utilisateurs non authentifiés et les redirige vers une page web d\'enregistrement ou d\'acceptation des conditions. C\'est la solution standard pour les réseaux Wi-Fi publics (hôtels, aéroports, cafés). Elle permet de collecter des informations, de faire accepter les CGU et éventuellement de facturer l\'accès, tout en étant simple d\'utilisation pour les clients.',
    difficulty: 'easy',
  },
  {
    id: 'p1-q188',
    phaseId: 'phase-01',
    lessonId: 'p1-network-security',
    question: 'Une entreprise déploie un système de téléphonie VoIP et craint que les conversations soient interceptées par un attaquant ayant accès au réseau. Quel protocole doit être utilisé pour chiffrer les flux audio en temps réel ?',
    options: [
      'HTTPS pour sécuriser les communications du serveur VoIP',
      'SRTP (Secure Real-time Transport Protocol) pour chiffrer les flux média',
      'SSH pour créer un tunnel sécurisé vers le serveur téléphonique',
      'IPsec en mode tunnel entre chaque téléphone IP',
    ],
    correctIndex: 1,
    explanation: 'SRTP (Secure Real-time Transport Protocol) est l\'extension sécurisée de RTP spécialement conçue pour chiffrer les flux média (audio et vidéo) en temps réel. Il offre la confidentialité (chiffrement AES), l\'authentification des paquets et la protection contre le rejeu. C\'est le standard pour sécuriser les communications VoIP sans introduire de latence significative.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q189',
    phaseId: 'phase-01',
    lessonId: 'p1-network-security',
    question: 'Un site web e-commerce subit une attaque DDoS volumétrique avec un trafic de 50 Gbps qui sature la connexion Internet. L\'infrastructure on-premise ne peut pas absorber ce volume. Où la solution de mitigation DDoS doit-elle être placée ?',
    options: [
      'Sur le pare-feu interne entre la DMZ et le réseau local',
      'En amont chez le fournisseur d\'accès Internet ou via un service cloud de mitigation DDoS (scrubbing center)',
      'Sur chaque serveur web de l\'infrastructure on-premise',
      'Sur le commutateur principal du centre de données',
    ],
    correctIndex: 1,
    explanation: 'Lorsqu\'une attaque DDoS volumétrique dépasse la capacité de la connexion Internet, la mitigation doit se faire en amont, avant que le trafic n\'atteigne l\'infrastructure. Les services cloud de mitigation DDoS (scrubbing centers) comme Cloudflare, Akamai ou AWS Shield absorbent le trafic malveillant dans leurs infrastructures distribuées à grande capacité et ne laissent passer que le trafic légitime.',
    difficulty: 'hard',
  },
  {
    id: 'p1-q190',
    phaseId: 'phase-01',
    lessonId: 'p1-network-security',
    question: 'Un administrateur réseau constate que le serveur DHCP est submergé de requêtes provenant d\'adresses MAC forgées, épuisant le pool d\'adresses IP disponibles. Quelle fonctionnalité du commutateur doit-il activer pour contrer cette attaque ?',
    options: [
      'Le port mirroring pour analyser le trafic suspect',
      'Le flood guard avec DHCP snooping et limitation du taux de requêtes par port',
      'Le protocole LACP pour agréger les liens réseau',
      'Le Quality of Service (QoS) pour prioriser les requêtes DHCP légitimes',
    ],
    correctIndex: 1,
    explanation: 'Le flood guard est un mécanisme de protection contre les attaques par inondation. Combiné au DHCP snooping, il valide les requêtes DHCP et limite le nombre de requêtes autorisées par port du commutateur (rate limiting). Le DHCP snooping maintient une table de correspondance MAC-IP-port fiable et bloque les requêtes provenant de ports non autorisés ou dépassant le seuil configuré, empêchant ainsi l\'épuisement du pool DHCP.',
    difficulty: 'hard',
  },

  // === Threat Analysis (q191-q195) ===
  {
    id: 'p1-q191',
    phaseId: 'phase-01',
    lessonId: 'p1-threat-analysis',
    question: 'Le directeur financier d\'une entreprise reçoit un appel téléphonique d\'une personne se faisant passer pour le support technique de la banque. L\'appelant demande de confirmer les identifiants du compte bancaire professionnel pour une "vérification de sécurité urgente". De quel type d\'attaque d\'ingénierie sociale s\'agit-il ?',
    options: [
      'Du phishing par email ciblé (spear phishing)',
      'Du vishing (voice phishing) exploitant l\'urgence et l\'autorité',
      'Du smishing via un message texte frauduleux',
      'Du whaling ciblant un cadre dirigeant par email',
    ],
    correctIndex: 1,
    explanation: 'Le vishing (voice phishing) est une attaque d\'ingénierie sociale menée par téléphone. L\'attaquant se fait passer pour une entité de confiance (banque, support IT, administration) et utilise des techniques de manipulation psychologique comme l\'urgence et l\'autorité pour obtenir des informations sensibles. La meilleure défense est de ne jamais divulguer d\'informations sensibles par téléphone et de rappeler l\'organisation via un numéro officiel.',
    difficulty: 'easy',
  },
  {
    id: 'p1-q192',
    phaseId: 'phase-01',
    lessonId: 'p1-threat-analysis',
    question: 'Plusieurs employés d\'une entreprise reçoivent un SMS contenant un lien vers un faux site de connexion Microsoft 365. Le message indique que leur compte sera désactivé sous 24 heures s\'ils ne vérifient pas leurs identifiants. Quel type d\'attaque est décrit ?',
    options: [
      'Une attaque de pharming modifiant les enregistrements DNS',
      'Une attaque de smishing (SMS phishing) avec un sentiment d\'urgence',
      'Une attaque de type man-in-the-middle sur le réseau cellulaire',
      'Une attaque par force brute sur les comptes Microsoft 365',
    ],
    correctIndex: 1,
    explanation: 'Le smishing est une variante du phishing utilisant les SMS (Short Message Service) comme vecteur d\'attaque. Les messages contiennent généralement un lien malveillant et créent un sentiment d\'urgence pour pousser la victime à agir sans réfléchir. Le fait que le message menace de désactiver le compte sous 24 heures est une technique classique de manipulation par l\'urgence.',
    difficulty: 'easy',
  },
  {
    id: 'p1-q193',
    phaseId: 'phase-01',
    lessonId: 'p1-threat-analysis',
    question: 'Dans un espace de coworking, un consultant remarque qu\'une personne assise derrière lui observe attentivement son écran pendant qu\'il saisit ses identifiants de connexion au VPN de l\'entreprise. De quelle technique d\'ingénierie sociale est-il victime ?',
    options: [
      'Du tailgating pour accéder à une zone restreinte',
      'Du shoulder surfing (espionnage par-dessus l\'épaule)',
      'Du dumpster diving dans les poubelles de l\'espace de coworking',
      'Du pretexting utilisant un faux prétexte pour obtenir des informations',
    ],
    correctIndex: 1,
    explanation: 'Le shoulder surfing consiste à observer par-dessus l\'épaule d\'une personne pour capturer des informations sensibles comme des mots de passe, des codes PIN ou des données confidentielles affichées à l\'écran. Les contre-mesures incluent l\'utilisation de filtres de confidentialité (privacy screens), le positionnement de l\'écran dos au mur et la vigilance dans les espaces publics.',
    difficulty: 'easy',
  },
  {
    id: 'p1-q194',
    phaseId: 'phase-01',
    lessonId: 'p1-threat-analysis',
    question: 'Un concurrent obtient des informations stratégiques confidentielles d\'une entreprise en fouillant systématiquement les bennes à ordures situées à l\'extérieur des bureaux. Des documents non déchiquetés contenant des organigrammes, des budgets et des listes clients y ont été retrouvés. De quelle attaque s\'agit-il ?',
    options: [
      'De l\'espionnage industriel via un malware implanté dans le réseau',
      'Du dumpster diving (fouille de poubelles) exploitant une mauvaise gestion des déchets',
      'De l\'ingénierie sociale par téléphone auprès des secrétaires',
      'D\'une attaque par exfiltration de données via un canal caché',
    ],
    correctIndex: 1,
    explanation: 'Le dumpster diving consiste à fouiller les poubelles et bennes à ordures d\'une organisation pour récupérer des informations sensibles jetées sans précaution. Des documents non déchiquetés, des disques durs non effacés ou des supports de stockage peuvent contenir des informations précieuses. La contre-mesure principale est d\'imposer le déchiquetage systématique de tous les documents sensibles et la destruction sécurisée des supports de stockage.',
    difficulty: 'easy',
  },
  {
    id: 'p1-q195',
    phaseId: 'phase-01',
    lessonId: 'p1-threat-analysis',
    question: 'Un employé tient la porte d\'accès à la salle serveur ouverte pour une personne portant un uniforme de technicien de maintenance, sans vérifier son badge d\'accès. Cette personne n\'est en réalité pas autorisée à entrer. Quel terme décrit PRÉCISÉMENT cette situation ?',
    options: [
      'Le piggybacking, car la personne non autorisée suit avec le consentement de l\'employé',
      'Le shoulder surfing, car le technicien observe les codes d\'accès',
      'Le pretexting, car le technicien utilise un faux prétexte',
      'Le baiting, car le technicien utilise un appât physique',
    ],
    correctIndex: 0,
    explanation: 'Le piggybacking se produit quand une personne non autorisée entre dans une zone sécurisée avec le consentement (même involontaire) d\'une personne autorisée qui lui tient la porte. Le tailgating est similaire mais se fait sans le consentement de la personne autorisée (en la suivant de près). Dans ce scénario, l\'employé tient volontairement la porte, ce qui correspond au piggybacking. La formation à la sensibilisation et les sas de sécurité (mantraps) sont les principales contre-mesures.',
    difficulty: 'medium',
  },

  // === Risk Management (q196-q198) ===
  {
    id: 'p1-q196',
    phaseId: 'phase-01',
    lessonId: 'p1-risk-management',
    question: 'Le département de la Défense d\'un pays exige que toutes les données soient classifiées avant stockage. Un document contenant des plans de déploiement militaire qui, s\'ils étaient divulgués, causeraient des dommages exceptionnellement graves à la sécurité nationale, devrait recevoir quel niveau de classification ?',
    options: [
      'Confidentiel (Confidential) - dommages potentiels à la sécurité nationale',
      'Secret - dommages sérieux à la sécurité nationale',
      'Top Secret - dommages exceptionnellement graves à la sécurité nationale',
      'Non classifié (Unclassified) - aucun impact sur la sécurité nationale',
    ],
    correctIndex: 2,
    explanation: 'Les niveaux de classification gouvernementaux sont : Unclassified (pas de dommage), Confidential (dommages), Secret (dommages sérieux) et Top Secret (dommages exceptionnellement graves à la sécurité nationale). Les plans de déploiement militaire, dont la divulgation causerait des dommages exceptionnellement graves, relèvent du niveau Top Secret. Chaque niveau impose des contrôles d\'accès et de manipulation de plus en plus stricts.',
    difficulty: 'easy',
  },
  {
    id: 'p1-q197',
    phaseId: 'phase-01',
    lessonId: 'p1-risk-management',
    question: 'Le service juridique d\'un cabinet d\'avocats demande combien de temps les dossiers clients électroniques doivent être conservés après la clôture d\'une affaire. L\'administrateur IT constate qu\'aucune politique formelle n\'existe. Quel document doit être créé en PRIORITÉ ?',
    options: [
      'Une politique de sauvegarde incrémentielle quotidienne des données',
      'Une politique de rétention des données définissant les durées de conservation par type de données',
      'Un plan de reprise d\'activité pour les systèmes de stockage',
      'Une procédure de chiffrement de tous les fichiers sur les serveurs',
    ],
    correctIndex: 1,
    explanation: 'Une politique de rétention des données (data retention policy) définit combien de temps chaque type de données doit être conservé, comment il doit être stocké pendant cette période, et comment il doit être détruit après expiration. Elle est essentielle pour la conformité légale (obligations réglementaires de conservation), la gestion du stockage et la réduction des risques liés à la conservation excessive de données.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q198',
    phaseId: 'phase-01',
    lessonId: 'p1-risk-management',
    question: 'Après une analyse de risques, l\'équipe sécurité identifie un risque résiduel lié à une application legacy qui ne peut pas être patchée. Le coût de remplacement dépasse le budget disponible. Le management décide de continuer à utiliser l\'application en connaissance de cause. Que doit faire le RSSI pour formaliser cette décision ?',
    options: [
      'Ignorer le risque et ne pas le documenter pour ne pas alarmer les auditeurs',
      'Transférer le risque à une compagnie d\'assurance cyber',
      'Documenter formellement l\'acceptation du risque avec la signature du management responsable',
      'Mettre en place un plan de mitigation sans informer le management du risque résiduel',
    ],
    correctIndex: 2,
    explanation: 'L\'acceptation du risque (risk acceptance) est une stratégie valide de traitement du risque, mais elle doit être formellement documentée. Le document doit inclure la description du risque, son impact potentiel, la justification de l\'acceptation, les mesures compensatoires en place, et la signature du responsable qui assume la responsabilité. Cette documentation protège l\'organisation lors des audits et clarifie la responsabilité.',
    difficulty: 'medium',
  },

  // === Incident Response (q199-q200) ===
  {
    id: 'p1-q199',
    phaseId: 'phase-01',
    lessonId: 'p1-incident-response',
    question: 'Une entreprise cotée en bourse subit une fuite de données affectant 500 000 clients. Le RSSI doit coordonner la communication autour de l\'incident. Plusieurs parties prenantes doivent être informées. Quel document devrait déjà définir QUI communique QUOI et À QUI lors d\'un tel incident ?',
    options: [
      'La politique de classification des données de l\'entreprise',
      'Le plan de communication d\'incident (incident communication plan) préétabli',
      'Le contrat de niveau de service (SLA) avec le fournisseur cloud',
      'Le rapport d\'audit de conformité annuel',
    ],
    correctIndex: 1,
    explanation: 'Un plan de communication d\'incident est un document préétabli qui définit les procédures de communication lors d\'un incident de sécurité. Il précise qui est le porte-parole, quelles parties prenantes doivent être informées (direction, juridique, régulateurs, clients, médias), dans quel délai, par quel canal et avec quel niveau de détail. Pour une entreprise cotée, la communication aux régulateurs et aux investisseurs est soumise à des obligations légales strictes.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q200',
    phaseId: 'phase-01',
    lessonId: 'p1-incident-response',
    question: 'Après avoir contenu et éradiqué un ransomware qui a paralysé l\'entreprise pendant trois jours, l\'équipe de réponse aux incidents se réunit pour analyser ce qui s\'est passé. L\'objectif est d\'identifier les améliorations à apporter. Comment s\'appelle cette étape ?',
    options: [
      'La phase de confinement (containment) de l\'incident',
      'La revue post-incident (post-incident review / lessons learned)',
      'La phase d\'éradication du malware des systèmes infectés',
      'La phase de restauration des systèmes à partir des sauvegardes',
    ],
    correctIndex: 1,
    explanation: 'La revue post-incident (aussi appelée lessons learned, post-mortem ou after-action review) est la dernière phase du processus de réponse aux incidents. L\'équipe analyse chronologiquement ce qui s\'est passé, ce qui a bien fonctionné, ce qui n\'a pas fonctionné, et identifie des améliorations concrètes. Le rapport produit alimente la mise à jour des procédures, des playbooks et des contrôles de sécurité pour mieux répondre aux futurs incidents.',
    difficulty: 'easy',
  },

  // === Secure Architecture (q201-q204) ===
  {
    id: 'p1-q201',
    phaseId: 'phase-01',
    lessonId: 'p1-secure-architecture',
    question: 'Un architecte sécurité conçoit la protection d\'un datacenter critique. Il recommande de combiner des barrières physiques, un contrôle d\'accès biométrique, un pare-feu réseau, un IPS, un antimalware sur les endpoints et du chiffrement des données. Quel principe de sécurité applique-t-il ?',
    options: [
      'Le principe du moindre privilège en limitant les accès au strict nécessaire',
      'La défense en profondeur (defense in depth) avec des couches de sécurité multiples',
      'La sécurité par l\'obscurité en cachant l\'architecture du système',
      'Le zero trust en ne faisant confiance à aucun utilisateur',
    ],
    correctIndex: 1,
    explanation: 'La défense en profondeur est une stratégie qui déploie plusieurs couches de contrôles de sécurité à différents niveaux : physique (barrières, serrures), réseau (pare-feu, IPS), hôte (antimalware, hardening), application (WAF, validation des entrées) et données (chiffrement, DLP). Si une couche est contournée, les couches suivantes continuent de protéger les actifs. Ce principe est inspiré des stratégies militaires défensives.',
    difficulty: 'easy',
  },
  {
    id: 'p1-q202',
    phaseId: 'phase-01',
    lessonId: 'p1-secure-architecture',
    question: 'Dans une banque, la politique exige que la personne qui initie un virement de plus de 50 000 euros ne puisse pas être la même personne qui l\'approuve. Deux personnes différentes doivent intervenir. Quel principe de sécurité est appliqué ?',
    options: [
      'Le principe de la rotation des tâches (job rotation)',
      'Le principe de la séparation des tâches (separation of duties)',
      'Le principe du besoin d\'en connaître (need-to-know)',
      'Le principe de la double authentification (dual-factor authentication)',
    ],
    correctIndex: 1,
    explanation: 'La séparation des tâches (separation of duties / SoD) est un contrôle de sécurité qui divise une tâche critique entre plusieurs personnes pour prévenir la fraude et les erreurs. Aucun individu seul ne peut exécuter une transaction sensible de bout en bout. Dans le contexte bancaire, cela signifie que l\'initiateur, l\'approbateur et parfois l\'auditeur sont des personnes différentes, créant un système de contrôles croisés.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q203',
    phaseId: 'phase-01',
    lessonId: 'p1-secure-architecture',
    question: 'Le responsable de la conformité d\'une entreprise insiste pour que les employés occupant des postes sensibles (comptabilité, approvisionnement) changent régulièrement de poste. Après deux ans, un comptable qui avait détourné des fonds depuis un an est découvert par son remplaçant. Quel contrôle a permis cette détection ?',
    options: [
      'L\'audit de sécurité annuel des systèmes informatiques',
      'La rotation des postes (job rotation) obligatoire pour les postes sensibles',
      'La vérification des antécédents lors de l\'embauche (background check)',
      'Le système de détection d\'intrusion sur le réseau financier',
    ],
    correctIndex: 1,
    explanation: 'La rotation des postes (job rotation) est un contrôle de sécurité qui oblige les employés à changer de fonction périodiquement. Cela sert deux objectifs : la détection de fraude (un nouveau titulaire découvre les irrégularités du précédent) et la réduction de la dépendance envers une seule personne. C\'est un contrôle particulièrement efficace dans les fonctions financières et comptables où un employé malveillant pourrait dissimuler ses activités frauduleuses pendant des années.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q204',
    phaseId: 'phase-01',
    lessonId: 'p1-secure-architecture',
    question: 'Le RSSI d\'une entreprise est le seul à connaître les procédures de réponse aux incidents critiques et les accès d\'urgence aux systèmes. Il est hospitalisé de manière imprévue pendant un mois. L\'entreprise se retrouve paralysée face à un incident majeur. Quel contrôle organisationnel aurait prévenu cette situation ?',
    options: [
      'L\'installation d\'un système SIEM pour automatiser la détection des incidents',
      'La planification de la succession (succession planning) avec documentation et formation croisée',
      'L\'externalisation complète de la sécurité à un MSSP',
      'La mise en place d\'une politique de mots de passe plus stricte',
    ],
    correctIndex: 1,
    explanation: 'La planification de la succession (succession planning) est un contrôle organisationnel qui garantit la continuité des opérations lorsqu\'un employé clé est indisponible. Elle inclut la documentation des procédures, la formation croisée d\'autres membres de l\'équipe, le stockage sécurisé des accès d\'urgence et l\'identification de remplaçants désignés. C\'est un élément essentiel du plan de continuité d\'activité (BCP).',
    difficulty: 'hard',
  },

  // === Application Security (q205-q206) ===
  {
    id: 'p1-q205',
    phaseId: 'phase-01',
    lessonId: 'p1-application-security',
    question: 'Un analyste SOC observe dans les logs qu\'un attaquant a réussi à voler le jeton de session d\'un utilisateur authentifié sur l\'application bancaire en ligne. L\'attaquant utilise maintenant ce jeton pour effectuer des virements depuis le compte de la victime. De quel type d\'attaque s\'agit-il ?',
    options: [
      'Une injection SQL dans le formulaire de connexion',
      'Un détournement de session (session hijacking) par vol de jeton',
      'Une attaque par déni de service sur le serveur d\'authentification',
      'Une attaque de type cross-site request forgery (CSRF)',
    ],
    correctIndex: 1,
    explanation: 'Le session hijacking (détournement de session) consiste à voler ou deviner le jeton de session d\'un utilisateur légitime pour usurper son identité. L\'attaquant peut obtenir le jeton par interception réseau (si non chiffré), par XSS, par prédiction ou par fixation de session. Les contre-mesures incluent le chiffrement TLS, les attributs de cookie sécurisés (HttpOnly, Secure, SameSite), la régénération du jeton après authentification et l\'expiration rapide des sessions.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q206',
    phaseId: 'phase-01',
    lessonId: 'p1-application-security',
    question: 'Un testeur de pénétration découvre qu\'il peut modifier les cookies d\'une application web pour changer son rôle de "user" à "admin" en éditant directement la valeur du cookie dans son navigateur. L\'application fait confiance aux données du cookie sans les vérifier côté serveur. Quelle vulnérabilité exploite-t-il ?',
    options: [
      'Une injection SQL dans les paramètres de requête',
      'Un empoisonnement de cookie (cookie poisoning) exploitant le manque de validation côté serveur',
      'Une attaque par force brute sur le mot de passe administrateur',
      'Un buffer overflow dans le serveur web',
    ],
    correctIndex: 1,
    explanation: 'Le cookie poisoning (empoisonnement de cookie) est une attaque où l\'attaquant modifie les valeurs stockées dans les cookies pour manipuler le comportement de l\'application. Si l\'application stocke des informations d\'autorisation (rôle, privilèges) dans les cookies sans validation côté serveur, un attaquant peut simplement les éditer pour escalader ses privilèges. La contre-mesure est de ne jamais faire confiance aux données côté client, de signer les cookies cryptographiquement et de vérifier les autorisations côté serveur.',
    difficulty: 'hard',
  },

  // === Cloud Security (q207-q208) ===
  {
    id: 'p1-q207',
    phaseId: 'phase-01',
    lessonId: 'p1-cloud-security',
    question: 'Plusieurs hôpitaux d\'une même région souhaitent partager une infrastructure cloud pour leurs systèmes de dossiers médicaux électroniques, tout en respectant les réglementations strictes du secteur de la santé. L\'infrastructure ne serait accessible qu\'aux établissements de santé participants. Quel modèle de déploiement cloud est le PLUS approprié ?',
    options: [
      'Un cloud public comme AWS ou Azure accessible à toutes les organisations',
      'Un cloud communautaire (community cloud) partagé entre les établissements de santé',
      'Un cloud privé hébergé individuellement par chaque hôpital',
      'Un cloud hybride combinant infrastructure on-premise et cloud public',
    ],
    correctIndex: 1,
    explanation: 'Le cloud communautaire (community cloud) est un modèle de déploiement partagé entre plusieurs organisations ayant des intérêts communs (même secteur, mêmes exigences réglementaires, mêmes besoins de sécurité). Dans le cas des hôpitaux, ils partagent les mêmes contraintes réglementaires (protection des données de santé) et bénéficient d\'économies d\'échelle tout en maintenant un contrôle supérieur à celui d\'un cloud public.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q208',
    phaseId: 'phase-01',
    lessonId: 'p1-cloud-security',
    question: 'Un site de vente en ligne connaît un pic de trafic de 500% lors du Black Friday. Grâce à son architecture cloud, de nouvelles instances de serveurs sont automatiquement provisionnées pour absorber la charge, puis désactivées quand le trafic diminue. Quelle caractéristique du cloud computing est décrite ?',
    options: [
      'La haute disponibilité via la redondance géographique',
      'L\'élasticité (elasticity) permettant l\'ajustement automatique des ressources à la demande',
      'La répartition de charge (load balancing) entre les serveurs existants',
      'La tolérance aux pannes (fault tolerance) des systèmes distribués',
    ],
    correctIndex: 1,
    explanation: 'L\'élasticité est la capacité d\'une infrastructure cloud à augmenter ou diminuer automatiquement les ressources en fonction de la demande en temps réel. Elle se distingue de la scalabilité (scalability) qui est la capacité à augmenter les ressources de manière planifiée. L\'élasticité est automatique et réactive, permettant de gérer des pics imprévisibles tout en optimisant les coûts en libérant les ressources inutilisées après le pic.',
    difficulty: 'easy',
  },

  // === Physical & IoT Security (q209-q210) ===
  {
    id: 'p1-q209',
    phaseId: 'phase-01',
    lessonId: 'p1-physical-iot-security',
    question: 'Une entreprise de logistique équipe ses chauffeurs de tablettes contenant des données clients sensibles. Le RSSI veut s\'assurer que ces tablettes ne puissent accéder aux données de l\'entreprise que lorsqu\'elles se trouvent dans les zones géographiques autorisées (entrepôts et routes de livraison). Quelle technologie doit-il implémenter ?',
    options: [
      'Le chiffrement complet du disque (FDE) sur toutes les tablettes',
      'Le geofencing pour restreindre les fonctionnalités en fonction de la localisation GPS',
      'Un VPN permanent entre les tablettes et le datacenter de l\'entreprise',
      'L\'authentification biométrique par empreinte digitale sur chaque tablette',
    ],
    correctIndex: 1,
    explanation: 'Le geofencing est une technologie de gestion des appareils mobiles (MDM) qui crée des périmètres géographiques virtuels à l\'aide du GPS, du Wi-Fi ou des données cellulaires. Lorsqu\'un appareil sort de la zone autorisée, des actions automatiques peuvent être déclenchées : blocage de l\'accès aux données d\'entreprise, verrouillage de l\'appareil, alerte à l\'administrateur ou effacement des données sensibles. C\'est un contrôle essentiel pour les appareils mobiles contenant des données sensibles.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q210',
    phaseId: 'phase-01',
    lessonId: 'p1-physical-iot-security',
    question: 'Un employé signale le vol de son smartphone professionnel contenant des emails confidentiels, des documents stratégiques et l\'accès au VPN de l\'entreprise. Le smartphone est perdu dans une ville étrangère. Quelle action l\'administrateur MDM doit-il exécuter IMMÉDIATEMENT ?',
    options: [
      'Envoyer un email à l\'employé lui demandant de changer ses mots de passe',
      'Exécuter un verrouillage à distance suivi d\'un effacement à distance (remote lock and wipe) de l\'appareil',
      'Désactiver le compte Wi-Fi de l\'employé sur le réseau de l\'entreprise',
      'Attendre 48 heures que l\'employé retrouve potentiellement son téléphone',
    ],
    correctIndex: 1,
    explanation: 'Le remote lock and wipe est une fonctionnalité MDM (Mobile Device Management) critique pour la gestion des appareils perdus ou volés. Le verrouillage à distance empêche immédiatement tout accès au contenu de l\'appareil, tandis que l\'effacement à distance (remote wipe) supprime toutes les données de l\'appareil. Dans le cas d\'un vol à l\'étranger, les chances de récupération sont minimes et le risque d\'exploitation des données est élevé, justifiant un effacement immédiat.',
    difficulty: 'hard',
  },
];
