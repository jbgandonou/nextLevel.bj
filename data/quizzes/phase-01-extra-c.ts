import { QuizQuestion } from '../types';

export const phase01ExtraC: QuizQuestion[] = [
  // === Cryptographie (q131-q137) ===
  {
    id: 'p1-q131',
    phaseId: 'phase-01',
    lessonId: 'p1-cryptographie',
    question: 'Marie doit implémenter un système de chiffrement pour des capteurs IoT disposant de très peu de mémoire et de puissance de calcul. Son responsable lui demande de choisir un algorithme asymétrique offrant une sécurité équivalente à RSA 3072 bits mais avec des clés beaucoup plus courtes. Quel algorithme devrait-elle privilégier ?',
    options: [
      'Diffie-Hellman avec des clés de 1024 bits',
      'ECC (Elliptic Curve Cryptography) avec des clés de 256 bits',
      'RSA avec des clés de 512 bits pour réduire la taille',
      'AES-256 en mode asymétrique',
    ],
    correctIndex: 1,
    explanation: 'ECC (Elliptic Curve Cryptography) offre un niveau de sécurité équivalent à RSA avec des clés beaucoup plus courtes. Une clé ECC de 256 bits fournit une sécurité comparable à une clé RSA de 3072 bits, ce qui la rend idéale pour les appareils à ressources limitées comme les capteurs IoT.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q132',
    phaseId: 'phase-01',
    lessonId: 'p1-cryptographie',
    question: 'Thomas conçoit un système de messagerie sécurisée. Il hésite entre un chiffrement par bloc et un chiffrement par flux pour chiffrer les messages en temps réel. Quel énoncé décrit correctement la différence entre ces deux approches ?',
    options: [
      'Un chiffrement par bloc traite les données bit par bit, tandis qu\'un chiffrement par flux traite des blocs de taille fixe',
      'Un chiffrement par flux chiffre les données bit par bit ou octet par octet en continu, tandis qu\'un chiffrement par bloc traite des segments de taille fixe comme 128 bits',
      'Les chiffrements par bloc sont toujours plus rapides que les chiffrements par flux',
      'Les chiffrements par flux ne peuvent pas être utilisés avec des algorithmes symétriques',
    ],
    correctIndex: 1,
    explanation: 'Un chiffrement par flux (comme RC4 ou ChaCha20) chiffre les données en continu, bit par bit ou octet par octet, en les combinant avec un flux de clés pseudo-aléatoire. Un chiffrement par bloc (comme AES) traite les données en segments de taille fixe (ex. : 128 bits). Les chiffrements par flux sont souvent privilégiés pour le chiffrement en temps réel.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q133',
    phaseId: 'phase-01',
    lessonId: 'p1-cryptographie',
    question: 'Sophie, administratrice sécurité, doit stocker les mots de passe des utilisateurs dans une base de données. Elle veut utiliser une technique de key stretching pour ralentir les attaques par force brute. Quels algorithmes sont spécifiquement conçus pour cet usage ?',
    options: [
      'MD5 et SHA-1, car ils sont rapides et largement disponibles',
      'PBKDF2 et bcrypt, car ils appliquent des itérations multiples pour ralentir le calcul',
      'AES-256 et RSA-2048, car ils fournissent un chiffrement fort',
      'Base64 et ROT13, car ils obfusquent efficacement les données',
    ],
    correctIndex: 1,
    explanation: 'PBKDF2 (Password-Based Key Derivation Function 2) et bcrypt sont des algorithmes de key stretching conçus pour ralentir délibérément le hachage des mots de passe. PBKDF2 applique une fonction de hachage des milliers de fois, et bcrypt intègre un facteur de coût ajustable, rendant les attaques par force brute et par dictionnaire beaucoup plus lentes et coûteuses.',
    difficulty: 'easy',
  },
  {
    id: 'p1-q134',
    phaseId: 'phase-01',
    lessonId: 'p1-cryptographie',
    question: 'Lucas, ingénieur réseau, configure un serveur web HTTPS. Son directeur technique lui demande de garantir que même si la clé privée du serveur est compromise dans le futur, les sessions passées resteront protégées. Quelle propriété cryptographique doit-il implémenter ?',
    options: [
      'Le chiffrement homomorphe pour protéger les données en transit',
      'La perfect forward secrecy (PFS) en utilisant des clés de session éphémères',
      'Le double chiffrement avec deux certificats SSL différents',
      'L\'utilisation exclusive de clés RSA statiques de 4096 bits',
    ],
    correctIndex: 1,
    explanation: 'La Perfect Forward Secrecy (PFS) garantit que chaque session utilise des clés éphémères uniques générées via des échanges Diffie-Hellman éphémères (DHE ou ECDHE). Ainsi, même si la clé privée du serveur est compromise ultérieurement, un attaquant ne pourra pas déchiffrer les sessions passées car les clés de session temporaires ont été détruites.',
    difficulty: 'hard',
  },
  {
    id: 'p1-q135',
    phaseId: 'phase-01',
    lessonId: 'p1-cryptographie',
    question: 'Un agent de renseignement doit transmettre un document confidentiel caché dans une photographie de paysage envoyée par e-mail, de sorte que personne ne soupçonne l\'existence du message. Quelle technique utilise-t-il ?',
    options: [
      'Le chiffrement symétrique AES-256',
      'La stéganographie, qui dissimule des données dans un fichier anodin',
      'Le hachage SHA-256 du document pour en vérifier l\'intégrité',
      'L\'obfuscation du code source avec un compilateur spécial',
    ],
    correctIndex: 1,
    explanation: 'La stéganographie est l\'art de dissimuler un message secret à l\'intérieur d\'un support anodin (image, fichier audio, vidéo) de manière à ce que l\'existence même du message reste invisible. Contrairement au chiffrement qui rend les données illisibles, la stéganographie cache le fait même qu\'une communication secrète a lieu.',
    difficulty: 'easy',
  },
  {
    id: 'p1-q136',
    phaseId: 'phase-01',
    lessonId: 'p1-cryptographie',
    question: 'Après une analyse de sécurité, Julien découvre que la base de données de mots de passe de son entreprise utilise SHA-256 sans sel (salt). Deux utilisateurs ayant le même mot de passe ont exactement le même hash stocké. Quelle mesure corrige cette vulnérabilité ?',
    options: [
      'Remplacer SHA-256 par MD5 qui génère des hachages plus courts et uniques',
      'Ajouter un sel (salt) unique et aléatoire à chaque mot de passe avant le hachage',
      'Chiffrer les hachages avec AES pour les rendre différents',
      'Utiliser un algorithme de compression avant le hachage',
    ],
    correctIndex: 1,
    explanation: 'Le salting consiste à ajouter une valeur aléatoire unique (le sel) à chaque mot de passe avant de le hacher. Même si deux utilisateurs ont le même mot de passe, leurs sels différents produiront des hachages distincts. Cela empêche les attaques par tables arc-en-ciel (rainbow tables) et rend les attaques par dictionnaire beaucoup plus difficiles.',
    difficulty: 'easy',
  },
  {
    id: 'p1-q137',
    phaseId: 'phase-01',
    lessonId: 'p1-cryptographie',
    question: 'Nadia développe une API bancaire et doit s\'assurer que chaque message échangé entre le client et le serveur n\'a pas été altéré et provient bien de l\'expéditeur légitime. Quel mécanisme cryptographique combine une fonction de hachage avec une clé secrète partagée pour garantir à la fois l\'intégrité et l\'authentification ?',
    options: [
      'Un certificat X.509 auto-signé',
      'Un HMAC (Hash-based Message Authentication Code)',
      'Un chiffrement RSA du message complet',
      'Une somme de contrôle CRC-32',
    ],
    correctIndex: 1,
    explanation: 'HMAC (Hash-based Message Authentication Code) combine une fonction de hachage cryptographique (comme SHA-256) avec une clé secrète partagée pour produire un code d\'authentification. Il garantit simultanément l\'intégrité du message (détection de toute modification) et l\'authentification de l\'origine (seul le détenteur de la clé secrète peut générer le HMAC correct).',
    difficulty: 'medium',
  },

  // === IAM - Gestion des identités et des accès (q138-q143) ===
  {
    id: 'p1-q138',
    phaseId: 'phase-01',
    lessonId: 'p1-iam',
    question: 'Une entreprise multinationale souhaite que ses employés puissent accéder aux applications de ses filiales partenaires sans créer de nouveaux comptes. Les utilisateurs s\'authentifient une seule fois auprès de leur organisation d\'origine. Quel concept décrit cette architecture ?',
    options: [
      'L\'authentification locale avec réplication LDAP',
      'L\'identité fédérée (Federated Identity), permettant l\'authentification inter-organisations',
      'Le VPN site-à-site avec authentification par certificat',
      'La gestion des comptes de service partagés entre filiales',
    ],
    correctIndex: 1,
    explanation: 'L\'identité fédérée permet aux utilisateurs de s\'authentifier auprès de leur fournisseur d\'identité (IdP) d\'origine et d\'accéder ensuite aux ressources d\'organisations partenaires sans créer de comptes supplémentaires. Des standards comme SAML, OAuth et OpenID Connect facilitent cette fédération en établissant des relations de confiance entre les organisations.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q139',
    phaseId: 'phase-01',
    lessonId: 'p1-iam',
    question: 'Une université déploie un système permettant aux étudiants d\'accéder à des ressources de bibliothèques numériques partagées entre plusieurs établissements universitaires. Le système utilise SAML pour l\'échange d\'assertions d\'identité. Quel logiciel open source est couramment utilisé dans le milieu académique pour cette fédération d\'identités ?',
    options: [
      'Apache Kafka pour la transmission des identités en temps réel',
      'Shibboleth, un système de fédération d\'identités basé sur SAML',
      'Wireshark pour analyser les paquets d\'authentification',
      'OpenVPN pour créer un tunnel sécurisé entre les universités',
    ],
    correctIndex: 1,
    explanation: 'Shibboleth est un logiciel open source largement utilisé dans le milieu académique et de la recherche pour la fédération d\'identités. Il implémente les standards SAML et permet aux institutions de partager des ressources tout en laissant chaque établissement gérer ses propres identités. Il est au cœur de fédérations comme Renater en France.',
    difficulty: 'hard',
  },
  {
    id: 'p1-q140',
    phaseId: 'phase-01',
    lessonId: 'p1-iam',
    question: 'Marc configure l\'authentification multi-facteurs pour les employés de son entreprise. Il compare TOTP et HOTP. Les employés voyagent souvent et n\'ont pas toujours accès au réseau. Quelle affirmation est correcte concernant ces deux protocoles ?',
    options: [
      'HOTP génère des codes basés sur le temps et expire après 30 secondes, tandis que TOTP utilise un compteur',
      'TOTP génère des codes basés sur le temps qui expirent automatiquement, tandis que HOTP génère des codes basés sur un compteur qui restent valides jusqu\'à utilisation',
      'TOTP et HOTP sont identiques mais portent des noms différents selon le fabricant',
      'HOTP nécessite obligatoirement une connexion réseau, contrairement à TOTP',
    ],
    correctIndex: 1,
    explanation: 'TOTP (Time-based One-Time Password) génère des codes qui changent toutes les 30 secondes en se basant sur l\'horloge. HOTP (HMAC-based One-Time Password) génère des codes basés sur un compteur incrémental ; le code reste valide jusqu\'à son utilisation. TOTP est généralement préféré car les codes expirent automatiquement, réduisant la fenêtre d\'attaque.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q141',
    phaseId: 'phase-01',
    lessonId: 'p1-iam',
    question: 'Antoine est administrateur système dans un hôpital. Un nouveau technicien de laboratoire vient d\'être embauché. Antoine lui accorde un accès en lecture seule aux résultats d\'analyses de son département, mais pas aux dossiers médicaux complets des patients. Quel principe de sécurité Antoine applique-t-il ?',
    options: [
      'La séparation des tâches (separation of duties)',
      'Le principe du moindre privilège (least privilege), limitant l\'accès au strict nécessaire',
      'Le contrôle d\'accès discrétionnaire (DAC) par le propriétaire des fichiers',
      'L\'authentification biométrique obligatoire pour le personnel médical',
    ],
    correctIndex: 1,
    explanation: 'Le principe du moindre privilège (least privilege) stipule que chaque utilisateur ne doit disposer que des permissions strictement nécessaires à l\'accomplissement de ses fonctions. En limitant l\'accès du technicien aux seuls résultats d\'analyses de son département, Antoine réduit la surface d\'attaque et protège les données sensibles des patients.',
    difficulty: 'easy',
  },
  {
    id: 'p1-q142',
    phaseId: 'phase-01',
    lessonId: 'p1-iam',
    question: 'Dans un environnement militaire, chaque document est classifié avec un niveau (Confidentiel, Secret, Très Secret) et chaque utilisateur possède une habilitation correspondante. Un analyste habilité "Secret" ne peut pas accéder aux documents "Très Secret", même s\'il en a besoin pour un projet. Quel modèle de contrôle d\'accès est utilisé ?',
    options: [
      'Le contrôle d\'accès basé sur les rôles (RBAC) avec des rôles militaires',
      'Le contrôle d\'accès discrétionnaire (DAC) où chaque auteur définit les permissions',
      'Le contrôle d\'accès obligatoire (MAC) avec des étiquettes de sécurité imposées par le système',
      'Le contrôle d\'accès basé sur les attributs (ABAC) selon la localisation',
    ],
    correctIndex: 2,
    explanation: 'Le contrôle d\'accès obligatoire (MAC - Mandatory Access Control) utilise des étiquettes de sécurité (labels) attribuées par le système, et non par les utilisateurs. Chaque ressource porte une classification et chaque utilisateur une habilitation. L\'accès est accordé uniquement si l\'habilitation de l\'utilisateur est au moins égale à la classification du document. Ce modèle est typique des environnements militaires et gouvernementaux.',
    difficulty: 'hard',
  },
  {
    id: 'p1-q143',
    phaseId: 'phase-01',
    lessonId: 'p1-iam',
    question: 'Claire travaille au département financier d\'une entreprise pharmaceutique. Elle participe à un projet de R&D et demande l\'accès aux brevets en cours de dépôt. L\'administrateur refuse car les brevets ne sont pas pertinents pour ses fonctions financières. Quel principe de sécurité justifie ce refus ?',
    options: [
      'Le principe de rotation des postes (job rotation)',
      'Le principe du besoin d\'en connaître (need-to-know), limitant l\'accès aux informations nécessaires au rôle',
      'Le principe de non-répudiation des accès',
      'Le principe d\'authentification forte obligatoire',
    ],
    correctIndex: 1,
    explanation: 'Le principe du besoin d\'en connaître (need-to-know) stipule que même si un utilisateur possède le niveau d\'habilitation suffisant, l\'accès n\'est accordé que si l\'information est directement nécessaire à l\'exercice de ses fonctions. Claire, malgré sa position dans l\'entreprise, n\'a pas besoin de connaître les brevets pour ses tâches financières.',
    difficulty: 'easy',
  },

  // === Sécurité réseau (q144-q150) ===
  {
    id: 'p1-q144',
    phaseId: 'phase-01',
    lessonId: 'p1-network-security',
    question: 'Une entreprise déploie un réseau Wi-Fi pour ses bureaux. L\'équipe sécurité recommande WPA2-Enterprise plutôt que WPA2-Personal. Quelle est la différence fondamentale entre ces deux modes ?',
    options: [
      'WPA2-Personal utilise un chiffrement AES plus fort que WPA2-Enterprise',
      'WPA2-Enterprise utilise un serveur RADIUS et l\'authentification 802.1X individuelle, tandis que WPA2-Personal partage une clé pré-partagée (PSK) unique',
      'WPA2-Enterprise fonctionne uniquement sur la bande 5 GHz',
      'WPA2-Personal est plus sécurisé car chaque utilisateur choisit son propre mot de passe',
    ],
    correctIndex: 1,
    explanation: 'WPA2-Enterprise (802.1X) authentifie chaque utilisateur individuellement via un serveur RADIUS, souvent couplé à un annuaire LDAP ou Active Directory. WPA2-Personal utilise une clé pré-partagée (PSK) commune à tous les utilisateurs. En entreprise, WPA2-Enterprise est préféré car il permet de révoquer l\'accès d\'un seul employé sans changer le mot de passe de tout le réseau.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q145',
    phaseId: 'phase-01',
    lessonId: 'p1-network-security',
    question: 'Fatou, analyste sécurité, reçoit des alertes indiquant que des employés se connectent à un point d\'accès Wi-Fi portant le même nom (SSID) que le réseau d\'entreprise, mais situé dans le parking. Les utilisateurs sont redirigés vers une fausse page de connexion. Quelle attaque est en cours ?',
    options: [
      'Une attaque par déni de service (DoS) sur le point d\'accès légitime',
      'Une attaque Evil Twin, utilisant un faux point d\'accès imitant le réseau légitime',
      'Une attaque par injection SQL sur le portail captif',
      'Une attaque par empoisonnement DNS sur le serveur DHCP',
    ],
    correctIndex: 1,
    explanation: 'L\'attaque Evil Twin consiste à créer un point d\'accès Wi-Fi malveillant avec le même SSID que le réseau légitime. Les victimes se connectent au faux AP, croyant être sur le réseau officiel. L\'attaquant peut alors intercepter tout le trafic, capturer des identifiants via de faux portails et lancer des attaques man-in-the-middle.',
    difficulty: 'easy',
  },
  {
    id: 'p1-q146',
    phaseId: 'phase-01',
    lessonId: 'p1-network-security',
    question: 'Pendant une conférence, Karim remarque que les appareils des participants se déconnectent fréquemment du Wi-Fi. L\'analyse réseau révèle de nombreuses trames de désauthentification envoyées par une adresse MAC inconnue. Quelle attaque subit le réseau ?',
    options: [
      'Une attaque par fragmentation de paquets IP',
      'Une attaque de désassociation (deauthentication), envoyant de fausses trames pour déconnecter les clients',
      'Une attaque par usurpation DHCP (DHCP starvation)',
      'Un brouillage de signal radio (jamming) sur la bande 2.4 GHz',
    ],
    correctIndex: 1,
    explanation: 'L\'attaque de désassociation (deauthentication attack) exploite les trames de gestion Wi-Fi non authentifiées dans les versions antérieures à WPA3. L\'attaquant envoie de fausses trames de désauthentification en usurpant l\'adresse MAC du point d\'accès, forçant les clients à se déconnecter. Cette attaque est souvent utilisée comme prélude à une attaque Evil Twin ou pour capturer le handshake WPA.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q147',
    phaseId: 'phase-01',
    lessonId: 'p1-network-security',
    question: 'L\'équipe réseau d\'un hôpital découvre un point d\'accès Wi-Fi non autorisé connecté à une prise réseau dans une salle d\'attente. L\'appareil n\'a été installé par aucun membre du personnel IT. Quel est le terme correct pour ce dispositif ?',
    options: [
      'Un répéteur Wi-Fi mal configuré',
      'Un point d\'accès pirate (rogue access point) installé sans autorisation sur le réseau',
      'Un pont réseau (bridge) pour étendre la couverture',
      'Un hotspot mobile partagé par un visiteur',
    ],
    correctIndex: 1,
    explanation: 'Un point d\'accès pirate (rogue access point) est un point d\'accès Wi-Fi non autorisé connecté au réseau d\'entreprise. Il peut avoir été installé par un employé bien intentionné ou par un attaquant. Dans les deux cas, il représente un risque majeur car il contourne les contrôles de sécurité réseau et peut offrir un accès non surveillé au réseau interne.',
    difficulty: 'easy',
  },
  {
    id: 'p1-q148',
    phaseId: 'phase-01',
    lessonId: 'p1-network-security',
    question: 'David, consultant en sécurité, évalue les risques liés aux technologies sans fil dans un immeuble de bureaux. Il identifie des risques liés au NFC utilisé pour les badges d\'accès et au Bluetooth des périphériques. Quelle attaque spécifique au Bluetooth permet d\'envoyer des messages non sollicités à des appareils à proximité ?',
    options: [
      'Le BlueSnarfing, qui permet de voler des données via Bluetooth',
      'Le Bluejacking, qui envoie des messages non sollicités à des appareils Bluetooth à proximité',
      'Le NFC Skimming, qui intercepte les communications NFC des badges',
      'Le Bluetooth Flooding, qui sature la bande de fréquence 2.4 GHz',
    ],
    correctIndex: 1,
    explanation: 'Le Bluejacking est une attaque qui consiste à envoyer des messages non sollicités (vCards, notes) à des appareils Bluetooth à proximité, généralement dans un rayon de 10 mètres. Bien que moins dangereuse que le BlueSnarfing (vol de données) ou le Bluebugging (prise de contrôle), elle peut être utilisée pour du phishing ou de l\'ingénierie sociale.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q149',
    phaseId: 'phase-01',
    lessonId: 'p1-network-security',
    question: 'Une entreprise possède trois sites géographiques (Paris, Lyon, Marseille) et souhaite connecter leurs réseaux de manière sécurisée via Internet. Les utilisateurs de chaque site doivent accéder aux ressources des autres sites de manière transparente, sans intervention manuelle. Quelle solution est la plus adaptée ?',
    options: [
      'Un VPN client-to-site pour chaque employé des trois sites',
      'Un VPN site-à-site permanent entre les trois localisations',
      'Un serveur proxy centralisé à Paris avec redirection du trafic',
      'Une connexion directe par fibre optique privée entre les trois villes',
    ],
    correctIndex: 1,
    explanation: 'Un VPN site-à-site crée des tunnels chiffrés permanents entre les passerelles VPN de chaque site, permettant aux réseaux de communiquer de manière transparente via Internet. Contrairement au VPN client-to-site (destiné aux télétravailleurs individuels), le VPN site-à-site ne requiert aucune configuration sur les postes clients et connecte automatiquement les réseaux entiers.',
    difficulty: 'easy',
  },
  {
    id: 'p1-q150',
    phaseId: 'phase-01',
    lessonId: 'p1-network-security',
    question: 'Amadou configure un VPN IPsec entre le siège de son entreprise et une succursale distante. Il doit choisir entre le mode tunnel et le mode transport. Le trafic traverse Internet et les adresses IP internes des deux réseaux doivent rester confidentielles. Quel mode doit-il sélectionner et pourquoi ?',
    options: [
      'Le mode transport, car il chiffre l\'intégralité du paquet y compris les en-têtes',
      'Le mode tunnel, car il encapsule le paquet IP original dans un nouveau paquet, masquant les adresses internes',
      'Le mode transport, car il est le seul compatible avec les VPN site-à-site',
      'Le mode tunnel, car il ne chiffre que la charge utile sans toucher aux en-têtes',
    ],
    correctIndex: 1,
    explanation: 'Le mode tunnel IPsec encapsule l\'intégralité du paquet IP original (en-têtes + données) dans un nouveau paquet IP avec de nouveaux en-têtes. Les adresses IP internes des réseaux sont ainsi masquées derrière les adresses IP des passerelles VPN. C\'est le mode standard pour les VPN site-à-site traversant Internet, car il protège la confidentialité de la topologie interne.',
    difficulty: 'hard',
  },

  // === Analyse des menaces (q151-q155) ===
  {
    id: 'p1-q151',
    phaseId: 'phase-01',
    lessonId: 'p1-threat-analysis',
    question: 'Un développeur mécontent, avant de quitter l\'entreprise, insère un code dans le système de paie qui supprimera toutes les données le 31 décembre si son compte utilisateur est désactivé. L\'IT découvre ce code deux mois après son départ. Quel type de malware a-t-il implanté ?',
    options: [
      'Un ver (worm) qui se propage dans le réseau automatiquement',
      'Une bombe logique (logic bomb), un code malveillant déclenché par une condition spécifique',
      'Un ransomware qui chiffrera les données le 31 décembre',
      'Un rootkit dissimulé dans le noyau du système d\'exploitation',
    ],
    correctIndex: 1,
    explanation: 'Une bombe logique (logic bomb) est un code malveillant inséré dans un système qui s\'active lorsqu\'une condition prédéfinie est remplie (date, événement, suppression d\'un compte). Ici, la condition est la désactivation du compte de l\'ancien employé. Les bombes logiques sont particulièrement dangereuses car elles peuvent rester dormantes pendant longtemps avant de se déclencher.',
    difficulty: 'easy',
  },
  {
    id: 'p1-q152',
    phaseId: 'phase-01',
    lessonId: 'p1-threat-analysis',
    question: 'L\'équipe SOC d\'une banque détecte qu\'un poste de travail communique régulièrement avec un serveur externe inconnu sur le port 443. L\'analyse révèle qu\'un attaquant peut exécuter des commandes à distance sur ce poste, capturer des écrans et exfiltrer des fichiers. Quel type de menace est identifié ?',
    options: [
      'Un adware affichant des publicités non désirées',
      'Un cheval de Troie d\'accès distant (RAT - Remote Access Trojan) avec une porte dérobée (backdoor)',
      'Un spyware limité à la collecte de l\'historique de navigation',
      'Un ver réseau (worm) se propageant via le port 443',
    ],
    correctIndex: 1,
    explanation: 'Un RAT (Remote Access Trojan) est un malware qui installe une porte dérobée (backdoor) permettant à un attaquant de contrôler un système à distance. Il offre des fonctionnalités comme l\'exécution de commandes, la capture d\'écran, le keylogging et l\'exfiltration de données. L\'utilisation du port 443 (HTTPS) permet au trafic malveillant de se fondre dans le trafic web légitime.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q153',
    phaseId: 'phase-01',
    lessonId: 'p1-threat-analysis',
    question: 'Un fournisseur d\'accès Internet remarque que des milliers de ses clients résidentiels envoient simultanément des requêtes vers un même site gouvernemental, provoquant sa mise hors service. L\'analyse montre que les routeurs domestiques ont été compromis par un malware et reçoivent des instructions d\'un serveur de commande. Quelle infrastructure d\'attaque est décrite ?',
    options: [
      'Une attaque par phishing de masse ciblant les employés gouvernementaux',
      'Un botnet contrôlé par un serveur de commande et contrôle (C2/C&C) lançant une attaque DDoS',
      'Une attaque par empoisonnement DNS redirigeant le trafic',
      'Un exploit zero-day ciblant le serveur web gouvernemental',
    ],
    correctIndex: 1,
    explanation: 'Un botnet est un réseau d\'appareils compromis (bots/zombies) contrôlés à distance par un attaquant via un serveur de commande et contrôle (C2 ou C&C). Les routeurs domestiques compromis forment le botnet, et le serveur C2 coordonne l\'attaque DDoS (Distributed Denial of Service). Les botnets modernes comme Mirai ciblent spécifiquement les appareils IoT et les routeurs domestiques.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q154',
    phaseId: 'phase-01',
    lessonId: 'p1-threat-analysis',
    question: 'Un auditeur de sécurité découvre qu\'un utilisateur standard d\'un serveur Linux a réussi à obtenir les privilèges root en exploitant une vulnérabilité dans un service système exécuté avec des droits élevés. L\'attaquant a ensuite installé un compte administrateur supplémentaire. Quel type d\'attaque a été réalisé ?',
    options: [
      'Une attaque par déni de service (DoS) ciblant le service vulnérable',
      'Une escalade de privilèges (privilege escalation) exploitant un service vulnérable',
      'Une attaque par force brute sur le mot de passe root',
      'Une attaque de type cross-site scripting (XSS) sur l\'interface web du serveur',
    ],
    correctIndex: 1,
    explanation: 'L\'escalade de privilèges (privilege escalation) est une attaque où un utilisateur obtient des droits supérieurs à ceux qui lui sont attribués. L\'escalade verticale (passer d\'utilisateur standard à root/admin) est la plus critique. Elle exploite souvent des vulnérabilités dans des services exécutés avec des privilèges élevés, des mauvaises configurations SUID/SGID ou des failles du noyau.',
    difficulty: 'hard',
  },
  {
    id: 'p1-q155',
    phaseId: 'phase-01',
    lessonId: 'p1-threat-analysis',
    question: 'L\'administrateur réseau d\'une université remarque que plusieurs serveurs de calcul scientifique ont une charge CPU constamment à 100%, même la nuit et les week-ends. L\'investigation révèle un processus caché qui mine de la cryptomonnaie en utilisant les ressources de l\'université. Quel type d\'attaque est-ce ?',
    options: [
      'Un ransomware qui chiffre les données des serveurs de calcul',
      'Du cryptojacking, l\'utilisation non autorisée de ressources informatiques pour miner de la cryptomonnaie',
      'Une attaque par déni de service interne saturant les CPU',
      'Un spyware collectant les résultats des recherches scientifiques',
    ],
    correctIndex: 1,
    explanation: 'Le cryptojacking est l\'utilisation non autorisée des ressources informatiques d\'une victime pour miner de la cryptomonnaie au profit de l\'attaquant. Contrairement aux ransomwares, le cryptojacking tente de rester discret le plus longtemps possible pour maximiser les gains. Les signes révélateurs incluent une utilisation CPU anormalement élevée, une consommation électrique accrue et des performances dégradées.',
    difficulty: 'easy',
  },

  // === Gestion des risques (q156-q158) ===
  {
    id: 'p1-q156',
    phaseId: 'phase-01',
    lessonId: 'p1-risk-management',
    question: 'Après une analyse de risques, le RSSI d\'une PME identifie que le risque d\'inondation de la salle serveur est élevé mais que le coût de déplacement des serveurs est prohibitif. Il décide de souscrire une assurance couvrant les dégâts matériels. Quelle stratégie de gestion des risques applique-t-il ?',
    options: [
      'L\'évitement du risque (risk avoidance) en supprimant la cause',
      'Le transfert du risque (risk transference) en déléguant l\'impact financier à un tiers',
      'L\'atténuation du risque (risk mitigation) en réduisant la probabilité',
      'L\'acceptation du risque (risk acceptance) en ne prenant aucune mesure',
    ],
    correctIndex: 1,
    explanation: 'Le transfert du risque (risk transference) consiste à déléguer l\'impact financier d\'un risque à un tiers, généralement par le biais d\'une assurance ou d\'un contrat de sous-traitance. Le risque lui-même existe toujours, mais les conséquences financières sont supportées par l\'assureur. C\'est une stratégie courante quand le coût de l\'atténuation dépasse le coût du transfert.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q157',
    phaseId: 'phase-01',
    lessonId: 'p1-risk-management',
    question: 'Le département RH d\'une entreprise signale que plusieurs employés ont cliqué sur des liens de phishing malgré les filtres anti-spam. Le RSSI décide de lancer un programme incluant des simulations de phishing mensuelles, des formations interactives et des rappels réguliers. Quelle mesure de sécurité met-il en place ?',
    options: [
      'Le déploiement d\'un nouveau pare-feu de nouvelle génération (NGFW)',
      'Un programme de sensibilisation à la sécurité (security awareness training)',
      'La mise en place d\'un système de détection d\'intrusion (IDS) sur les messageries',
      'L\'implémentation du chiffrement de bout en bout pour tous les e-mails',
    ],
    correctIndex: 1,
    explanation: 'La sensibilisation à la sécurité (security awareness training) est une mesure essentielle qui vise à éduquer les employés sur les menaces et les bonnes pratiques. Les simulations de phishing testent la vigilance des utilisateurs, les formations renforcent les connaissances, et les rappels maintiennent la sensibilisation. Cette approche réduit significativement le facteur humain, qui reste la première cause de compromission.',
    difficulty: 'easy',
  },
  {
    id: 'p1-q158',
    phaseId: 'phase-01',
    lessonId: 'p1-risk-management',
    question: 'L\'équipe IT doit mettre à jour le firmware critique de tous les commutateurs réseau. Le responsable exige qu\'un processus formel soit suivi : demande écrite, évaluation d\'impact, approbation par un comité, tests en environnement de pré-production, plan de retour arrière, et documentation. Quel processus est décrit ?',
    options: [
      'La gestion des incidents (incident management) avec escalade hiérarchique',
      'La gestion des changements (change management), un processus formel pour contrôler les modifications',
      'La gestion des vulnérabilités (vulnerability management) avec correctifs',
      'La gestion de la continuité d\'activité (BCP) en cas de panne réseau',
    ],
    correctIndex: 1,
    explanation: 'La gestion des changements (change management) est un processus formel qui encadre toute modification apportée aux systèmes d\'information. Elle inclut la soumission d\'une demande de changement (RFC), l\'analyse d\'impact, l\'approbation par un comité consultatif (CAB), les tests, un plan de retour arrière (rollback) et la documentation. Ce processus réduit les risques d\'indisponibilité et d\'erreurs humaines.',
    difficulty: 'medium',
  },

  // === Réponse aux incidents (q159-q160) ===
  {
    id: 'p1-q159',
    phaseId: 'phase-01',
    lessonId: 'p1-incident-response',
    question: 'Après la détection d\'une intrusion sur un serveur, l\'analyste forensique doit créer une copie exacte du disque dur pour analyse sans altérer les preuves originales. Il utilise un outil qui crée une copie bit-à-bit du disque, incluant l\'espace non alloué et les fichiers supprimés. Quelle procédure suit-il ?',
    options: [
      'Une sauvegarde incrémentale du serveur vers un NAS',
      'La création d\'une image forensique (forensic image) bit-à-bit du disque',
      'Un clonage du système d\'exploitation vers une machine virtuelle',
      'Une exportation des journaux système vers un serveur SIEM',
    ],
    correctIndex: 1,
    explanation: 'L\'imagerie forensique (forensic imaging) crée une copie bit-à-bit exacte d\'un support de stockage, incluant tous les secteurs : données actives, espace non alloué, fichiers supprimés et métadonnées. Des outils comme dd, FTK Imager ou EnCase sont utilisés. Un hash (MD5/SHA-256) est calculé pour vérifier l\'intégrité de la copie. L\'original est ensuite mis sous scellés pour préserver la chaîne de custody.',
    difficulty: 'hard',
  },
  {
    id: 'p1-q160',
    phaseId: 'phase-01',
    lessonId: 'p1-incident-response',
    question: 'Lors d\'une investigation numérique, l\'équipe forensique doit collecter les preuves d\'un serveur compromis. Le responsable insiste pour que les données les plus volatiles soient collectées en premier. Dans quel ordre les preuves doivent-elles être collectées selon le principe d\'ordre de volatilité ?',
    options: [
      'Disque dur → Fichiers temporaires → Cache → Mémoire RAM → Registres CPU',
      'Registres CPU et cache → Mémoire RAM → État du réseau → Processus en cours → Disque dur',
      'Journaux système → Fichiers de configuration → Base de données → Sauvegardes → Mémoire RAM',
      'Sauvegardes externes → Disque dur → Mémoire RAM → Cache → Registres CPU',
    ],
    correctIndex: 1,
    explanation: 'L\'ordre de volatilité (RFC 3227) dicte la collecte des preuves de la plus volatile à la moins volatile : registres CPU et cache (disparaissent immédiatement), mémoire RAM (perdue à l\'extinction), état réseau et connexions actives, processus en cours, puis disque dur et supports amovibles. Ce principe garantit que les preuves éphémères sont capturées avant qu\'elles ne disparaissent.',
    difficulty: 'hard',
  },

  // === Architecture sécurisée (q161-q163) ===
  {
    id: 'p1-q161',
    phaseId: 'phase-01',
    lessonId: 'p1-secure-architecture',
    question: 'Une plateforme de commerce en ligne doit garantir une disponibilité de 99,99%. L\'architecte propose de déployer l\'application sur plusieurs serveurs travaillant ensemble, de sorte que si un serveur tombe en panne, les autres prennent automatiquement le relais sans interruption. Quelle solution met-il en place ?',
    options: [
      'Un système de sauvegarde automatique quotidienne vers le cloud',
      'Un cluster de haute disponibilité (HA clustering) avec basculement automatique',
      'Un équilibreur de charge DNS round-robin sans vérification de santé',
      'Un serveur unique surpuissant avec des composants redondants internes',
    ],
    correctIndex: 1,
    explanation: 'Le clustering haute disponibilité (HA clustering) regroupe plusieurs serveurs qui fonctionnent comme une entité unique. Si un nœud tombe en panne, les autres détectent la défaillance et reprennent automatiquement la charge (failover). Combiné avec un équilibreur de charge et des vérifications de santé, ce mécanisme garantit une continuité de service quasi-ininterrompue.',
    difficulty: 'medium',
  },
  {
    id: 'p1-q162',
    phaseId: 'phase-01',
    lessonId: 'p1-secure-architecture',
    question: 'Le réseau d\'une entreprise repose sur un seul lien fibre optique vers Internet. Après une coupure de câble ayant causé 8 heures d\'indisponibilité, la direction demande une solution pour éviter qu\'un seul point de défaillance ne paralyse l\'entreprise. Quelle approche l\'architecte réseau devrait-il recommander ?',
    options: [
      'Augmenter la bande passante du lien existant de 1 Gbps à 10 Gbps',
      'Mettre en place une redondance réseau avec un second lien via un fournisseur différent et un chemin physique distinct',
      'Installer un cache proxy local pour stocker les pages web fréquemment visitées',
      'Déployer un pare-feu supplémentaire pour protéger le lien existant',
    ],
    correctIndex: 1,
    explanation: 'La redondance réseau élimine les points de défaillance uniques (SPOF) en dupliquant les composants critiques. Un second lien Internet via un fournisseur différent et un chemin physique distinct garantit la connectivité même si un lien ou un fournisseur est défaillant. Cette approche, combinée avec un routage dynamique (BGP), permet un basculement automatique.',
    difficulty: 'easy',
  },
  {
    id: 'p1-q163',
    phaseId: 'phase-01',
    lessonId: 'p1-secure-architecture',
    question: 'Suite à un incendie dans le datacenter principal d\'une compagnie d\'assurance, les systèmes critiques sont restés indisponibles pendant 5 jours. La direction mandate l\'équipe IT pour définir un plan garantissant la reprise des opérations en moins de 4 heures après un sinistre majeur. Quel document et quelle infrastructure doivent-ils mettre en place ?',
    options: [
      'Une politique de mots de passe renforcée et un audit de sécurité annuel',
      'Un plan de reprise après sinistre (DRP - Disaster Recovery Plan) avec un site de secours de type hot site',
      'Un programme de sensibilisation des employés aux risques d\'incendie',
      'Un contrat de maintenance étendu avec le fournisseur du datacenter',
    ],
    correctIndex: 1,
    explanation: 'Un plan de reprise après sinistre (DRP) définit les procédures pour restaurer les systèmes critiques après un sinistre majeur. Un hot site est un site de secours entièrement équipé avec des serveurs actifs et des données répliquées en temps réel, permettant un basculement en quelques heures (faible RTO). À la différence d\'un cold site (local vide) ou d\'un warm site (équipement partiellement configuré), le hot site offre la reprise la plus rapide.',
    difficulty: 'hard',
  },

  // === Sécurité des applications (q164-q166) ===
  {
    id: 'p1-q164',
    phaseId: 'phase-01',
    lessonId: 'p1-application-security',
    question: 'Un développeur web crée un formulaire de connexion. Sans aucune vérification, un attaquant saisit " \' OR 1=1 -- " dans le champ utilisateur et obtient un accès non autorisé. L\'architecte sécurité demande de corriger cette faille. Quelle est la mesure la plus efficace ?',
    options: [
      'Augmenter la longueur maximale du champ utilisateur à 256 caractères',
      'Implémenter la validation des entrées (input validation) avec des requêtes paramétrées (prepared statements)',
      'Masquer le champ mot de passe avec des astérisques',
      'Ajouter un CAPTCHA sur la page de connexion',
    ],
    correctIndex: 1,
    explanation: 'La validation des entrées (input validation) et l\'utilisation de requêtes paramétrées (prepared statements) sont les défenses principales contre l\'injection SQL. Les requêtes paramétrées séparent le code SQL des données utilisateur, empêchant l\'interprétation de l\'entrée malveillante comme du code. La validation des entrées ajoute une couche supplémentaire en rejetant les caractères ou formats inattendus.',
    difficulty: 'easy',
  },
  {
    id: 'p1-q165',
    phaseId: 'phase-01',
    lessonId: 'p1-application-security',
    question: 'L\'équipe de développement d\'une fintech effectue une revue de code et découvre que les clés API sont codées en dur dans le code source, que les erreurs affichent des traces de pile complètes aux utilisateurs, et que les sessions n\'expirent jamais. Le responsable sécurité demande l\'application des bonnes pratiques de développement sécurisé. Quelle approche globale doit être adoptée ?',
    options: [
      'Réécrire l\'application dans un langage de programmation plus sécurisé',
      'Appliquer les pratiques de codage sécurisé : externaliser les secrets, gérer les erreurs sans divulgation, et implémenter l\'expiration des sessions',
      'Déployer un WAF (Web Application Firewall) pour compenser les faiblesses du code',
      'Effectuer uniquement des tests de pénétration trimestriels',
    ],
    correctIndex: 1,
    explanation: 'Les pratiques de codage sécurisé (secure coding practices) incluent : ne jamais coder en dur les secrets (utiliser des coffres-forts de secrets), implémenter une gestion d\'erreurs qui ne révèle pas d\'informations internes (messages génériques pour les utilisateurs, logs détaillés côté serveur), et gérer les sessions avec des délais d\'expiration. Ces pratiques s\'inscrivent dans une approche "security by design".',
    difficulty: 'hard',
  },
  {
    id: 'p1-q166',
    phaseId: 'phase-01',
    lessonId: 'p1-application-security',
    question: 'Une équipe QA sécurité doit tester une application de gestion bancaire avant sa mise en production. Ils utilisent un outil qui envoie automatiquement des millions de données aléatoires, malformées et inattendues aux points d\'entrée de l\'application pour provoquer des comportements anormaux. Quelle technique de test utilisent-ils ?',
    options: [
      'Le test de charge (load testing) pour évaluer les performances sous stress',
      'Le fuzzing, une technique envoyant des données aléatoires et malformées pour détecter des vulnérabilités',
      'Le test de régression pour vérifier que les anciens bugs ne réapparaissent pas',
      'L\'analyse statique du code source (SAST) sans exécution',
    ],
    correctIndex: 1,
    explanation: 'Le fuzzing (fuzz testing) est une technique de test automatisé qui consiste à injecter des données aléatoires, malformées ou inattendues dans les entrées d\'un programme pour provoquer des plantages, des fuites de mémoire ou des comportements anormaux révélant des vulnérabilités. C\'est une méthode efficace pour découvrir des bugs que les tests manuels et l\'analyse statique pourraient manquer.',
    difficulty: 'medium',
  },

  // === Sécurité cloud (q167-q168) ===
  {
    id: 'p1-q167',
    phaseId: 'phase-01',
    lessonId: 'p1-cloud-security',
    question: 'Une startup déploie ses microservices dans des conteneurs Docker sur Kubernetes. L\'équipe sécurité s\'inquiète car plusieurs conteneurs utilisent des images de base téléchargées depuis des dépôts publics sans vérification. Un conteneur compromis pourrait potentiellement accéder aux autres. Quelle pratique de sécurité des conteneurs est prioritaire ?',
    options: [
      'Désactiver la virtualisation matérielle pour améliorer l\'isolation',
      'Scanner les images de conteneurs pour détecter les vulnérabilités, utiliser des images de base minimales et appliquer le principe du moindre privilège',
      'Exécuter tous les conteneurs avec les privilèges root pour éviter les erreurs de permission',
      'Héberger les conteneurs sur des serveurs physiques dédiés au lieu de machines virtuelles',
    ],
    correctIndex: 1,
    explanation: 'La sécurité des conteneurs repose sur plusieurs piliers : scanner régulièrement les images pour détecter les vulnérabilités connues (avec des outils comme Trivy ou Clair), utiliser des images de base minimales (Alpine, distroless) pour réduire la surface d\'attaque, ne jamais exécuter les conteneurs en tant que root, et appliquer des politiques réseau pour limiter la communication inter-conteneurs.',
    difficulty: 'hard',
  },
  {
    id: 'p1-q168',
    phaseId: 'phase-01',
    lessonId: 'p1-cloud-security',
    question: 'Une entreprise migre son application de traitement de commandes vers une architecture serverless (AWS Lambda). Le développeur se demande si les préoccupations de sécurité traditionnelles s\'appliquent toujours. Quel risque de sécurité spécifique au serverless le RSSI doit-il souligner ?',
    options: [
      'Les attaques DDoS sont impossibles en architecture serverless car le cloud scale automatiquement',
      'Les fonctions serverless peuvent être vulnérables à l\'injection via les événements déclencheurs, aux permissions IAM excessives et à l\'exposition de secrets dans les variables d\'environnement',
      'Le fournisseur cloud gère intégralement la sécurité applicative en serverless',
      'Le serverless élimine tous les risques liés aux dépendances et bibliothèques tierces',
    ],
    correctIndex: 1,
    explanation: 'En architecture serverless, bien que le fournisseur gère l\'infrastructure, la sécurité applicative reste de la responsabilité du client (modèle de responsabilité partagée). Les risques incluent : l\'injection via les sources d\'événements (API Gateway, S3, SQS), les permissions IAM trop larges sur les fonctions, les secrets stockés en clair dans les variables d\'environnement, et les dépendances vulnérables dans les packages déployés.',
    difficulty: 'hard',
  },

  // === Sécurité physique et IoT (q169-q170) ===
  {
    id: 'p1-q169',
    phaseId: 'phase-01',
    lessonId: 'p1-physical-iot-security',
    question: 'Lisa supervise des processus dans une usine de traitement des eaux via des systèmes SCADA. Des administrateurs découvrent un malware sur le réseau opérationnel qui tente de modifier les paramètres des automates programmables (PLC) contrôlant le dosage chimique. Quelle mesure peut le mieux atténuer ce risque ?',
    options: [
      'Installer un antivirus grand public sur les postes SCADA',
      'Segmenter le réseau OT (opérationnel) du réseau IT avec des pare-feux industriels et des zones démilitarisées (DMZ) dédiées',
      'Connecter les systèmes SCADA directement à Internet pour faciliter les mises à jour',
      'Remplacer tous les automates programmables par des ordinateurs standards',
    ],
    correctIndex: 1,
    explanation: 'La segmentation réseau entre les réseaux IT et OT (Operational Technology) est la mesure fondamentale pour protéger les systèmes SCADA/ICS. Des pare-feux industriels, des DMZ dédiées et le modèle Purdue (architecture en couches) limitent les flux entre les deux environnements. Les systèmes SCADA ne doivent jamais être directement accessibles depuis le réseau IT ou Internet, comme l\'ont démontré des attaques comme Stuxnet.',
    difficulty: 'hard',
  },
  {
    id: 'p1-q170',
    phaseId: 'phase-01',
    lessonId: 'p1-physical-iot-security',
    question: 'Un hôpital déploie des pompes à perfusion connectées et des moniteurs de signes vitaux reliés au réseau. L\'audit de sécurité révèle que ces appareils utilisent des systèmes d\'exploitation obsolètes non patchés, des identifiants par défaut et des protocoles non chiffrés. Quelle caractéristique des systèmes embarqués rend leur sécurisation particulièrement difficile ?',
    options: [
      'Les systèmes embarqués sont trop puissants et consomment trop de bande passante',
      'Les systèmes embarqués ont des ressources limitées, des cycles de mise à jour longs et utilisent souvent des firmwares propriétaires difficiles à patcher',
      'Les systèmes embarqués sont naturellement immunisés contre les cyberattaques',
      'Les systèmes embarqués ne peuvent communiquer qu\'en Bluetooth, limitant les vecteurs d\'attaque',
    ],
    correctIndex: 1,
    explanation: 'Les systèmes embarqués (embedded systems) dans le domaine médical ou industriel présentent des défis de sécurité uniques : ressources de calcul et mémoire limitées empêchant l\'installation d\'agents de sécurité, firmwares propriétaires avec des cycles de mise à jour très longs (parfois des années), utilisation de protocoles hérités non chiffrés, identifiants codés en dur, et durée de vie des appareils dépassant souvent le support du fabricant.',
    difficulty: 'medium',
  },
];
